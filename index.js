/* empty css                      */import{S as w,N as _,P as D,A as q,K as H,M as N,i as U}from"./assets/vendor-COF5X-Zm.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const n of i.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&r(n)}).observe(document,{childList:!0,subtree:!0});function o(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=o(s);fetch(s.href,i)}})();w.use([_,D,q,H,N]);document.addEventListener("DOMContentLoaded",function(){const e=document.querySelector(".feedbacks-slider");if(!e){console.error("Swiper: Контейнер .feedbacks-slider не знайдено.");return}new w(e,{slidesPerView:1,spaceBetween:24,watchOverflow:!0,navigation:{nextEl:".swiper-arrows .swiper-button-next",prevEl:".swiper-arrows .swiper-button-prev"},pagination:{el:".carousel-navigation .swiper-pagination",clickable:!0},a11y:{enabled:!0},keyboard:{enabled:!0},mousewheel:{enabled:!0,forceToAxis:!0},breakpoints:{320:{slidesPerView:1,spaceBetween:24},768:{slidesPerView:2,spaceBetween:32},1440:{slidesPerView:3,spaceBetween:32}}})});new w(".heroSwiper",{cssMode:!0,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},keyboard:!0});const z="https://books-backend.p.goit.global",F=1e4,v=3,G=1e3,g={initialPerPageMobile:10,initialPerPageDesktop:24,perLoadMore:4,mobileBreakpoint:768,tabletBreakpoint:1024},S={maxSize:50,ttl:5*60*1e3},B=["Hardcover Fiction","Hardcover Nonfiction","Trade Fiction Paperback","Mass Market Monthly","Paperback Trade Fiction","Paperback Nonfiction","E-Book Fiction","E-Book Nonfiction","Hardcover Advice","Paperback Advice","Advice How-To and Miscellaneous","Children's Middle Grade Hardcover","Picture Books","Series Books","Young Adult Hardcover","Audio Fiction","Audio Nonfiction","Business Books","Graphic Books and Manga","Mass Market","Middle Grade Paperback","Young Adult Paperback"],l={booksGrid:"books-grid",booksLoader:"books-loader",showMoreBtn:"show-more-btn",categoriesList:"categories-list",categoriesLoader:"categories-loader",booksError:"books-error",booksCounter:"books-counter-text",categoriesSelectTablet:"categories-select-tablet",categoriesSelectMobile:"categories-select-mobile"},K={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"},C={EMAILS:"emails"},p=3e3,m={REQUIRED:"* Required field",INVALID:"Please enter a valid email",SUCCESS:"Email saved!"};async function M(e,t={}){const o=new AbortController,r=setTimeout(()=>o.abort(),F);let s=null;for(let i=1;i<=v;i++)try{const n=await fetch(`${z}${e}`,{signal:o.signal,headers:{"Content-Type":"application/json",Accept:"application/json"},...t});if(clearTimeout(r),!n.ok){const u=await n.text().catch(()=>"");throw new Error(`API ${n.status}: ${n.statusText}. ${u}`)}return await n.json()}catch(n){if(s=n,n.name==="AbortError")throw new Error("Request timeout. Please check your connection.");if(i===v)throw s;await new Promise(u=>setTimeout(u,G*i))}}function T(e,t=""){return{id:e.primary_isbn13||e.primary_isbn10||e.title||"no-id",title:e.title||"Untitled",author:e.author||"Unknown Author",image:e.book_image||t,amazon_product_url:e.amazon_product_url||"#",price:e.price||""}}class V{constructor(t=S.maxSize,o=S.ttl){this.cache=new Map,this.maxSize=t,this.ttl=o}set(t,o){this.cache.size>=this.maxSize&&this.cache.delete(this.cache.keys().next().value),this.cache.set(t,{value:o,t:Date.now()})}get(t){const o=this.cache.get(t);return o?Date.now()-o.t>this.ttl?(this.cache.delete(t),null):o.value:null}clear(){this.cache.clear()}}class Y{constructor(){this.cache=new V}async getCategories(){const t="categories",o=this.cache.get(t);if(o)return o;try{const r=await M("/books/category-list");let s=[];r&&Array.isArray(r.results)&&(s=r.results.map(n=>typeof n=="object"&&n.list_name?{name:n.list_name,value:n.list_name}:typeof n=="string"?{name:n,value:n}:null).filter(Boolean)),s.length||(s=B.map(n=>({name:n,value:n})));const i=[{name:"All Categories",value:"all"},...s];return this.cache.set(t,i),i}catch{return[{name:"All Categories",value:"all"},...B.map(r=>({name:r,value:r}))]}}async getBooks(t="all",o=1,r=20){var n;const s=`books_${t}_${o}_${r}`,i=this.cache.get(s);if(i)return i;try{let u="/books/top-books";t!=="all"&&(u=`/books/category?category=${encodeURIComponent(t)}`);const d=await M(u);let h=[];(n=d==null?void 0:d.results)!=null&&n.length?h=d.results.map(T):Array.isArray(d)&&(h=d.map(T));const E=(o-1)*r,f=E+r,L={books:h.slice(E,f),total:h.length,showing:Math.min(f,h.length),hasMore:f<h.length,currentPage:o};return this.cache.set(s,L),L}catch(u){throw new Error(`Failed to load books: ${u.message}`)}}}const A=new Y;function c(e){return e?String(e).replace(/[&<>"']/g,t=>K[t]):""}function x(e,t=0){const o=document.createElement("li");o.className="book-card",o.style.animationDelay=`${t%8*.05+.1}s`;const r=e.price&&e.price!=="$0"?e.price:"";return o.innerHTML=`
    <div class="book-media">
      <img
        class="book-cover loading"
        src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='227' height='323'%3E%3Crect width='100%25' height='100%25' fill='%23f0f0f0'/%3E%3C/svg%3E"
        ${e.image?`data-src="${e.image}"`:""}
        alt="${c(e.title)}"
        loading="lazy"
      >
    </div>
    <div class="book-info">
      <div class="book-title-row">
        <h3 class="book-title">${c(e.title)}</h3>
        ${r?`<span class="book-price">${c(r)}</span>`:""}
      </div>
      <p class="book-author">${c(e.author)}</p>
    </div>
    <div class="book-footer">
      <button
        class="learn-more-btn"
        type="button"
        data-book-id="${c(e.id)}"
        data-amazon-url="${c(e.amazon_product_url)}"
      >
        Learn More
      </button>
    </div>
  `,o}function j(e,t,o){return`
    <li class="category-item ${o?"active":""}" data-category="${c(t)}">
      <button class="category-button" type="button" data-category="${c(t)}">
        ${c(e)}
      </button>
    </li>
  `}function Q(e,t,o="all"){e&&(e.innerHTML=t.map(r=>j(r.name,r.value,r.value===o)).join(""))}function J(e,t,o="all"){e.forEach(r=>{r&&(r.innerHTML=t.map(s=>`<option value="${c(s.value)}" ${s.value===o?"selected":""}>
          ${c(s.name)}
        </option>`).join(""))})}function W(e,t){e&&(e.innerHTML="",t==null||t.forEach((o,r)=>e.appendChild(x(o,r))))}function X(e,t){if(!e||!(t!=null&&t.length))return;const o=e.children.length;t.forEach((r,s)=>e.appendChild(x(r,o+s)))}function Z(e,t,o){e&&(e.textContent=`Showing ${t} of ${o}`)}function ee(e,t,o){if(!e)return;const r=e.querySelector(".button-text");r&&(o?(r.textContent="Loading...",e.disabled=!0):t?(r.textContent="Show More",e.disabled=!1,e.style.display="block"):e.style.display="none")}function I(e,t){if(!e)return;const o=e.querySelector(".error-message");o&&(o.textContent=t),e.style.display="block"}function P(e){e&&(e.style.display="none")}function te(e,t,o){e==null||e.classList.toggle("hidden",!o),t==null||t.setAttribute("aria-busy",String(o))}function O(e,t){e==null||e.classList.toggle("hidden",!t)}function oe(e,t){e&&e.querySelectorAll(".category-item").forEach(o=>{o.classList.toggle("active",o.dataset.category===t)})}document.getElementById("open-modal-btn");const a={footerForm:document.querySelector(".footer-input-box"),footerInput:document.querySelector(".footer-input"),footerRemark:document.querySelector(".footer-remark"),footerBtn:document.querySelector(".footer-btn")};function re(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function se(e){const t=JSON.parse(localStorage.getItem(C.EMAILS))||[];t.includes(e)||(t.push(e),localStorage.setItem(C.EMAILS,JSON.stringify(t)))}function ne(e){return()=>e.loadMore()}function ie(){return e=>{const t=e.target.closest(".learn-more-btn");if(!t)return;e.preventDefault();const o=t.dataset.amazonUrl;o&&o!=="#"&&window.open(o,"_blank","noopener,noreferrer")}}function ae(e){return()=>{e.debounceTimeout&&clearTimeout(e.debounceTimeout),e.debounceTimeout=setTimeout(()=>{var o;(((o=e.elements.booksGrid)==null?void 0:o.querySelectorAll(".book-card"))??[]).forEach((r,s)=>r.style.animationDelay=`${s%8*.05+.1}s`)},250)}}function $(e){return t=>e.filterByCategory(t.target.value)}function ce(e){return t=>{const o=t.currentTarget.closest(".category-item"),r=o==null?void 0:o.dataset.category;r&&r!==e.currentCategory&&e.filterByCategory(r)}}function le(e){return()=>e.loadBooks(!0)}function ue(e){return new IntersectionObserver(t=>{t.forEach(o=>{o.isIntersecting&&e(o.target)})},{rootMargin:"50px 0px"})}function de(e,t){const o=e.dataset.src;if(!o)return;e.classList.add("loading");const r=new Image;r.onload=()=>{e.src=o,e.classList.remove("loading"),e.classList.add("loaded"),delete e.dataset.src,t==null||t.unobserve(e)},r.onerror=()=>{e.classList.remove("loading"),e.classList.add("error"),t==null||t.unobserve(e)},r.src=o}function b(e,t,o){U[e]({title:t,message:o,position:"topRight"})}function he(e){e.preventDefault();const t=a.footerInput.value.trim();if(a.footerBtn.classList.remove("btn-error","btn-success"),a.footerRemark.classList.remove("remark-error","remark-success"),!t){a.footerRemark.textContent=m.REQUIRED,a.footerRemark.classList.add("remark-error"),b("warning","Caution",m.REQUIRED),setTimeout(y,p);return}if(!re(t)){a.footerRemark.textContent=m.INVALID,a.footerRemark.classList.add("remark-error"),a.footerBtn.classList.add("btn-error"),b("error","Error",m.INVALID),setTimeout(y,p);return}a.footerRemark.textContent="✅ "+m.SUCCESS,a.footerRemark.classList.add("remark-success"),a.footerBtn.classList.add("btn-success"),b("success","OK",m.SUCCESS),se(t),setTimeout(y,p),a.footerForm.reset()}function y(){a.footerRemark.textContent="",a.footerRemark.classList.remove("remark-error","remark-success"),a.footerBtn.classList.remove("btn-error","btn-success")}class me{constructor(){this.elements={booksGrid:document.getElementById(l.booksGrid),booksLoader:document.getElementById(l.booksLoader),showMoreBtn:document.getElementById(l.showMoreBtn),categoriesUL:document.getElementById(l.categoriesList),categoriesLoader:document.getElementById(l.categoriesLoader),errorElement:document.getElementById(l.booksError),booksCounter:document.getElementById(l.booksCounter),categoriesSelectTablet:document.getElementById(l.categoriesSelectTablet),categoriesSelectMobile:document.getElementById(l.categoriesSelectMobile)},this.currentCategory="all",this.currentPage=1,this.isLoading=!1,this.hasMore=!0,this.loadedBooks=[],this.imageObserver=null,this.debounceTimeout=null,this.init()}async init(){try{P(this.elements.errorElement),this.setupEventListeners(),this.setupObservers(),await this.renderCategories(),await this.loadBooks(!0)}catch(t){console.error("Books init error:",t),I(this.elements.errorElement,"Failed to load books. Please try again.")}}setupEventListeners(){var t,o,r,s,i,n;(t=this.elements.showMoreBtn)==null||t.addEventListener("click",ne(this)),(o=this.elements.booksGrid)==null||o.addEventListener("click",ie()),window.addEventListener("resize",ae(this)),(r=this.elements.categoriesSelectTablet)==null||r.addEventListener("change",$(this)),(s=this.elements.categoriesSelectMobile)==null||s.addEventListener("change",$(this)),(n=(i=this.elements.errorElement)==null?void 0:i.querySelector(".retry-btn"))==null||n.addEventListener("click",le(this))}setupObservers(){"IntersectionObserver"in window&&(this.imageObserver=ue(t=>de(t,this.imageObserver)))}async renderCategories(){if(this.elements.categoriesUL){O(this.elements.categoriesLoader,!0);try{const t=await A.getCategories();Q(this.elements.categoriesUL,t,this.currentCategory),this.elements.categoriesUL.querySelectorAll(".category-button").forEach(o=>o.addEventListener("click",ce(this))),J([this.elements.categoriesSelectTablet,this.elements.categoriesSelectMobile],t,this.currentCategory)}finally{O(this.elements.categoriesLoader,!1)}}}async loadBooks(t=!1){if(!this.isLoading){this.setLoading(!0),P(this.elements.errorElement);try{const o=t?this.getInitialBooksCount():g.perLoadMore,r=t?1:this.currentPage+1,s=await A.getBooks(this.currentCategory,r,o);t?(this.loadedBooks=[...s.books],this.currentPage=1,W(this.elements.booksGrid,this.loadedBooks)):(this.loadedBooks.push(...s.books),this.currentPage=r,X(this.elements.booksGrid,s.books)),this.setupLazyLoading(),this.hasMore=s.hasMore,this.updateShowMoreButton(),Z(this.elements.booksCounter,s.showing,s.total)}catch(o){console.error("Load books error:",o),I(this.elements.errorElement,`Failed to load books: ${o.message}`)}finally{this.setLoading(!1)}}}setupLazyLoading(){var t;this.imageObserver&&((t=this.elements.booksGrid)==null||t.querySelectorAll(".book-cover[data-src]").forEach(o=>this.imageObserver.observe(o)))}async filterByCategory(t){t!==this.currentCategory&&(this.currentCategory=t,this.currentPage=1,this.loadedBooks=[],oe(this.elements.categoriesUL,t),this.elements.categoriesSelectTablet&&(this.elements.categoriesSelectTablet.value=t),this.elements.categoriesSelectMobile&&(this.elements.categoriesSelectMobile.value=t),await this.loadBooks(!0))}async loadMore(){!this.hasMore||this.isLoading||await this.loadBooks(!1)}updateShowMoreButton(){ee(this.elements.showMoreBtn,this.hasMore,this.isLoading)}getInitialBooksCount(){return window.innerWidth<=g.mobileBreakpoint?g.initialPerPageMobile:g.initialPerPageDesktop}setLoading(t){this.isLoading=t,te(this.elements.booksLoader,this.elements.booksGrid,t),this.updateShowMoreButton()}destroy(){var t;(t=this.imageObserver)==null||t.disconnect(),this.debounceTimeout&&clearTimeout(this.debounceTimeout)}}function R(){document.getElementById("books-section")&&new me}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",R):R();a.footerForm.addEventListener("submit",he);document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();const o=document.querySelector(this.getAttribute("href"));o&&o.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})})});const k=document.querySelector(".scroll-top"),ge=document.querySelector(".hero");function fe(e){e.forEach(t=>{t.isIntersecting?k.classList.add("hidden"):k.classList.remove("hidden")})}const pe=new IntersectionObserver(fe);pe.observe(ge);function be(){window.scrollTo({top:0,behavior:"smooth"})}k.addEventListener("click",be);
//# sourceMappingURL=index.js.map
