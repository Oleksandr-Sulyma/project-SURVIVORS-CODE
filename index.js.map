{"version":3,"file":"index.js","sources":["../src/js/burger-menu.js","../src/js/slider-feedbacks.js","../src/js/slider-hero.js","../src/js/constants.js","../src/js/api-service.js","../src/js/refs.js","../src/js/storage.js","../src/js/cart.js","../src/js/render-functions.js","../src/js/modal-book.js","../src/js/helpers.js","../src/js/handlers.js","../src/js/books-data.js","../src/js/books.js","../src/js/modal-contact.js","../src/js/slider-events.js","../src/js/join-form.js","../src/js/scroll-top.js"],"sourcesContent":["const refs = {\r\n  navbar: document.querySelector('[data-navbar]'),\r\n  burgerOpen: document.querySelector('[data-navbar-open]'),\r\n  burgerClose: document.querySelector('[data-navbar-close]'),\r\n  navbarLink: document.querySelector('.navbar-nav-list'),\r\n};\r\n\r\nrefs.burgerOpen.addEventListener('click', () => {\r\n  refs.navbar.classList.remove('is-close');\r\n  refs.navbar.classList.add('is-open');\r\n  refs.burgerOpen.setAttribute('aria-expanded', 'true');\r\n  document.body.classList.add('no-scroll');\r\n});\r\n\r\nfunction closeNavbar() {\r\n  refs.navbar.classList.replace('is-open', 'is-close');\r\n  document.body.classList.remove('no-scroll');\r\n  refs.burgerOpen.setAttribute('aria-expanded', 'false');\r\n}\r\n\r\nrefs.burgerClose.addEventListener('click', () => {\r\n  closeNavbar();\r\n});\r\n\r\nrefs.navbarLink.addEventListener('click', e => {\r\n  if (e.target.className === 'navbar-nav-list') {\r\n    return;\r\n  }\r\n  closeNavbar();\r\n});\r\n","import Swiper from 'swiper';\nimport 'swiper/css';\nimport 'swiper/css/navigation';\nimport 'swiper/css/pagination';\nimport {\n  Navigation,\n  Pagination,\n  A11y,\n  Keyboard,\n  Mousewheel,\n} from 'swiper/modules';\n\nSwiper.use([Navigation, Pagination, A11y, Keyboard, Mousewheel]);\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  const swiperElement = document.querySelector('.feedbacks-slider');\n\n  if (!swiperElement) {\n    console.error('Swiper: Контейнер .feedbacks-slider не знайдено.');\n    return;\n  }\n\n  const swiper = new Swiper(swiperElement, {\n    slidesPerView: 1,\n    spaceBetween: 24,\n    watchOverflow: true,\n\n    navigation: {\n      nextEl: '.feedbacks-arrows .swiper-button-next',\n      prevEl: '.feedbacks-arrows .swiper-button-prev',\n    },\n    pagination: {\n      el: '.feedbacks .carousel-navigation .feedbacks-pagination',\n      clickable: true,\n    },\n    a11y: {\n      enabled: true,\n    },\n    keyboard: {\n      enabled: true,\n    },\n    mousewheel: {\n      enabled: true,\n      forceToAxis: true,\n    },\n\n    breakpoints: {\n      320: {\n        slidesPerView: 1,\n      },\n      768: {\n        slidesPerView: 2,\n      },\n      1440: {\n        slidesPerView: 3,\n      },\n    },\n  });\n});\n","import Swiper from 'swiper/bundle';\nimport 'swiper/css/bundle';\n\nconst swiper = new Swiper('.heroSwiper', {\n  spaceBetween: 2,\n  slidesPerView: 1,\n  speed: 1000,\n  keyboard: {\n    enabled: true,\n  },\n  autoplay: {\n    delay: 5000,\n    disableOnInteraction: false,\n  },\n  on: {\n    init: () => {\n      document.querySelector('.heroSwiper').style.visibility = 'visible';\n    },\n  },\n});\n\nconst nextBtn = document.querySelector('.button-next');\nconst prevBtn = document.querySelector('.button-prev');\n\nfunction updateButtons() {\n  if (swiper.isBeginning) {\n    prevBtn.disabled = true;\n    prevBtn.classList.add('disabled');\n  } else {\n    prevBtn.disabled = false;\n    prevBtn.classList.remove('disabled');\n  }\n\n  if (swiper.isEnd) {\n    nextBtn.disabled = true;\n    nextBtn.classList.add('disabled');\n  } else {\n    nextBtn.disabled = false;\n    nextBtn.classList.remove('disabled');\n  }\n}\n\nupdateButtons();\n\nswiper.on('slideChange', updateButtons);\n\nnextBtn.addEventListener('click', () => {\n  swiper.slideNext();\n});\n\nprevBtn.addEventListener('click', () => {\n  swiper.slidePrev();\n});\n","export const BOOKS_BASE_URL = 'https://books-backend.p.goit.global';\nexport const REQUEST_TIMEOUT = 10000;\nexport const RETRY_ATTEMPTS = 3;\nexport const RETRY_DELAY = 1000;\n\n// UI/логіка\nexport const BOOKS_CONFIG = {\n  initialPerPageMobile: 10,\n  initialPerPageDesktop: 24,\n  perLoadMoreDesktop: 4,\n  perLoadMoreMobile: 4,\n  mobileBreakpoint: 768,\n  tabletBreakpoint: 1024,\n};\n\n// Cache\nexport const CACHE_CONFIG = {\n  maxSize: 50,\n  ttl: 5 * 60 * 1000,\n};\n\n// Фолбек-категорії\nexport const FALLBACK_CATEGORIES = [\n  'Hardcover Fiction',\n  'Hardcover Nonfiction',\n  'Trade Fiction Paperback',\n  'Mass Market Monthly',\n  'Paperback Trade Fiction',\n  'Paperback Nonfiction',\n  'E-Book Fiction',\n  'E-Book Nonfiction',\n  'Hardcover Advice',\n  'Paperback Advice',\n  'Advice How-To and Miscellaneous',\n  \"Children's Middle Grade Hardcover\",\n  'Picture Books',\n  'Series Books',\n  'Young Adult Hardcover',\n  'Audio Fiction',\n  'Audio Nonfiction',\n  'Business Books',\n  'Graphic Books and Manga',\n  'Mass Market',\n  'Middle Grade Paperback',\n  'Young Adult Paperback',\n];\n\n// ID елементів у DOM\nexport const DOM_ELEMENTS = {\n  booksGrid: 'books-grid',\n  booksLoader: 'books-loader',\n  showMoreBtn: 'show-more-btn',\n  categoriesList: 'categories-list',\n  categoriesLoader: 'categories-loader',\n  booksError: 'books-error',\n  booksCounter: 'books-counter-text',\n  categoriesSelectTablet: 'categories-select-tablet',\n  categoriesSelectMobile: 'categories-select-mobile',\n};\n\n// для екранування\nexport const HTML_ESCAPE_MAP = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#039;',\n};\n\n// -----footer-----\nexport const STORAGE_KEYS = {\n  EMAILS: 'emails',\n};\n\nexport const TOAST_DELAY = 3000;\n\nexport const MESSAGES = {\n  REQUIRED: '* Required field',\n  INVALID: 'Please enter a valid email',\n  SUCCESS: 'Email saved!',\n};\n// -----footer-end-----\n\n// ----modal-book------\nexport const CARTKEY = 'cart';\nexport const BUYKEY = 'buy';\nexport const ORDERKEY = 'order';\n","import {\n  BOOKS_BASE_URL,\n  REQUEST_TIMEOUT,\n  RETRY_ATTEMPTS,\n  RETRY_DELAY,\n  FALLBACK_CATEGORIES,\n  CACHE_CONFIG,\n} from './constants.js';\n\nimport axios from 'axios';\n\n/* -------------------------- exports -------------------------- */\nexport { fetchJSON, normalizeBook, api };\n\n/* -------------------------- fetch helpers -------------------------- */\nasync function fetchJSON(path, options = {}) {\n  const controller = new AbortController();\n  const timeoutId = setTimeout(() => controller.abort(), REQUEST_TIMEOUT);\n  let lastError = null;\n\n  for (let attempt = 1; attempt <= RETRY_ATTEMPTS; attempt++) {\n    try {\n      const res = await fetch(`${BOOKS_BASE_URL}${path}`, {\n        signal: controller.signal,\n        headers: {\n          'Content-Type': 'application/json',\n          Accept: 'application/json',\n        },\n        ...options,\n      });\n      clearTimeout(timeoutId);\n\n      if (!res.ok) {\n        const txt = await res.text().catch(() => '');\n        throw new Error(`API ${res.status}: ${res.statusText}. ${txt}`);\n      }\n      return await res.json();\n    } catch (err) {\n      lastError = err;\n      if (err.name === 'AbortError')\n        throw new Error('Request timeout. Please check your connection.');\n      if (attempt === RETRY_ATTEMPTS) throw lastError;\n      await new Promise(r => setTimeout(r, RETRY_DELAY * attempt));\n    }\n  }\n}\n\n/* -------------------------- normalization -------------------------- */\nfunction normalizeBook(book, fallbackImage = '') {\n  return {\n    id: book._id || 'no-id',\n    title: book.title || 'Untitled',\n    author: book.author || 'Unknown Author',\n    image: book.book_image || fallbackImage,\n    amazon_product_url: book.amazon_product_url || '#',\n    price: book.price || '',\n  };\n}\n\n/* -------------------------- canonization -------------------------- */\nfunction canon(s) {\n  return String(s || '')\n    .toLowerCase()\n    .normalize('NFKD')\n    .replace(/[\\u0300-\\u036f]/g, '')\n    .replace(/&amp;/g, '&')\n    .replace(/\\s+/g, ' ')\n    .replace(/[^\\p{L}\\p{N}\\s]/gu, '')\n    .trim();\n}\n\n/* -------------------------- deduplication -------------------------- */\nfunction dedupeStable(list) {\n  const out = [];\n  const byId = new Set();\n  const byTA = new Set();\n\n  for (const b of list) {\n    if (b?.id && b.id !== 'no-id') {\n      const k = `id:${b.id}`;\n      if (byId.has(k)) continue;\n      byId.add(k);\n      const ta = `ta:${canon(b.title)}|${canon(b.author)}`;\n      byTA.add(ta);\n      out.push(b);\n      continue;\n    }\n\n    const ta = `ta:${canon(b.title)}|${canon(b.author)}`;\n    if (byTA.has(ta)) continue;\n    byTA.add(ta);\n    out.push(b);\n  }\n\n  return out;\n}\n\n/* ------------------------------ cache ------------------------------ */\nclass MemoryCache {\n  constructor(maxSize = CACHE_CONFIG.maxSize, ttl = CACHE_CONFIG.ttl) {\n    this.cache = new Map();\n    this.maxSize = maxSize;\n    this.ttl = ttl;\n  }\n  set(key, value) {\n    if (this.cache.size >= this.maxSize) {\n      const first = this.cache.keys().next().value;\n      this.cache.delete(first);\n    }\n    this.cache.set(key, { value, ts: Date.now() });\n  }\n  get(key) {\n    const item = this.cache.get(key);\n    if (!item) return null;\n    if (Date.now() - item.ts > this.ttl) {\n      this.cache.delete(key);\n      return null;\n    }\n    return item.value;\n  }\n  clear() {\n    this.cache.clear();\n  }\n}\n\n/* ------------------------------- API -------------------------------- */\nclass BooksAPI {\n  constructor() {\n    this.cache = new MemoryCache();\n  }\n\n  async getCategories() {\n    const key = 'categories';\n    const cached = this.cache.get(key);\n    if (cached) return cached;\n\n    try {\n      const data = await fetchJSON('/books/category-list');\n      let categories = [];\n\n      if (data && Array.isArray(data.results)) {\n        categories = data.results\n          .map(c => {\n            if (typeof c === 'object' && c.list_name)\n              return { name: c.list_name, value: c.list_name };\n            if (typeof c === 'string') return { name: c, value: c };\n            return null;\n          })\n          .filter(Boolean);\n      }\n      if (!categories.length)\n        categories = FALLBACK_CATEGORIES.map(n => ({ name: n, value: n }));\n      const result = [{ name: 'All Categories', value: 'all' }, ...categories];\n      this.cache.set(key, result); // Виправлено: k на key\n      return result;\n    } catch {\n      return [\n        { name: 'All Categories', value: 'all' },\n        ...FALLBACK_CATEGORIES.map(n => ({ name: n, value: n })),\n      ];\n    }\n  }\n\n  async getBooks(category = 'all', page = 1, limit) {\n    if (!limit) {\n      limit = window.innerWidth <= 768 ? 10 : 24;\n    }\n\n    const k = `books_${category}_${page}_${limit}`;\n    const cached = this.cache.get(k);\n    if (cached) return cached;\n\n    try {\n      let endpoint = '/books/top-books';\n      if (category !== 'all') {\n        endpoint = `/books/category?category=${encodeURIComponent(category)}`;\n      }\n\n      const data = await fetchJSON(endpoint);\n      const allBooks = [];\n      const seen = new Set();\n\n      if (category === 'all') {\n        if (Array.isArray(data)) {\n          data.forEach(list => {\n            if (Array.isArray(list.books)) {\n              list.books.forEach(b => {\n                const book = normalizeBook(b);\n                const key = `${book.title}__${book.image}`;\n                if (!seen.has(key)) {\n                  seen.add(key);\n                  allBooks.push(book);\n                }\n              });\n            }\n          });\n        }\n      } else {\n        const booksArray = data?.results?.length\n          ? data.results\n          : Array.isArray(data)\n          ? data\n          : [];\n        booksArray.forEach(b => {\n          const book = normalizeBook(b);\n          const key = `${book.title}__${book.image}`;\n          if (!seen.has(key)) {\n            seen.add(key);\n            allBooks.push(book);\n          }\n        });\n      }\n\n      if (!allBooks.length) {\n        console.log(`У категорії \"${category}\" немає книг.`);\n      }\n\n      const start = (page - 1) * limit;\n      const end = start + limit;\n\n      const result = {\n        books: allBooks.slice(start, end),\n        total: allBooks.length,\n        showing: Math.min(end, allBooks.length),\n        hasMore: end < allBooks.length,\n        currentPage: page,\n      };\n\n      this.cache.set(k, result);\n      return result;\n    } catch (e) {\n      throw new Error(`Failed to load books: ${e.message}`);\n    }\n  }\n}\n\nconst api = new BooksAPI();\n\nexport const getBookById = async id => {\n  try {\n    const { data } = await axios.get(`${BOOKS_BASE_URL}/books/${id}`);\n    return data;\n  } catch (error) {\n    throw new Error(`Failed to load books: ${error.message}`);\n  }\n};","export default {\n  elBookModal: document.querySelector('#book-modal'),\n  elModalContent: document.querySelector('.modal-book-container'),\n  elBtnOpenModal: document.getElementById('open-modal-btn'),\n  footerForm: document.querySelector('.footer-input-box'),\n  footerInput: document.querySelector('.footer-input'),\n  footerRemark: document.querySelector('.footer-remark'),\n  footerBtn: document.querySelector('.footer-btn'),\n  elModalCloseBtn: document.querySelector('.modal-close-btn'),  \n};\n\n","// -----footer-----\nimport { STORAGE_KEYS } from './constants.js';\n\nexport function saveEmailToLocal(email) {\n  const emails = JSON.parse(localStorage.getItem(STORAGE_KEYS.EMAILS)) || [];\n  if (!emails.includes(email)) {\n    emails.push(email);\n    localStorage.setItem(STORAGE_KEYS.EMAILS, JSON.stringify(emails));\n  }\n}\n\nexport function getEmailsFromLocal() {\n  return JSON.parse(localStorage.getItem(STORAGE_KEYS.EMAILS)) || [];\n}\n// -----footer-end-----\n\n//------modal-book-----\nexport const setLocalStorage = (key, array) =>\n  localStorage.setItem(key, JSON.stringify(array));\n\nexport const getLocalStorage = key =>\n  JSON.parse(localStorage.getItem(key)) || [];\n\nexport const removeLocalStorage = key => localStorage.removeItem(key);\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport refs from './refs.js';\nimport { CARTKEY } from './constants.js';\nimport {\n getLocalStorage,\n setLocalStorage,\n removeLocalStorage, \n} from './storage.js';\n\nexport function isBookInCart(bookId) {\n const cartArr = getLocalStorage(CARTKEY);\n return cartArr.some(item => item.id === bookId);\n}\n\nexport function updateCartButtonState(actionBtn, bookId) {\n if (isBookInCart(bookId)) {\n  actionBtn.textContent = 'Remove from Cart';\n  actionBtn.dataset.action = 'remove-from-cart';\n } else {\n  actionBtn.textContent = 'Add to Cart';\n  actionBtn.dataset.action = 'add-to-cart';\n }\n}\n\nexport function handleQuantityChange(targetBtn) {\n const quantityControl = targetBtn.closest('.quantity-control');\n const input = quantityControl.querySelector('.quantity-input');\n \n let value = parseInt(input.value);\n const min = parseInt(input.min) || 1;\n const max = parseInt(input.max) || 99;\n\n if (targetBtn.classList.contains('increase-btn') && value < max) {\n  input.value = value + 1;\n } else if (targetBtn.classList.contains('decrease-btn') && value > min) {\n  input.value = value - 1;\n }\n\n quantityControl.querySelector('.decrease-btn').disabled =\n  parseInt(input.value) <= min;\n}\n\nexport function handleCartAction(actionBtn, currentBook) {\n const action = actionBtn.dataset.action;\n const quantityInput = refs.elModalContent.querySelector('.quantity-input');\n const quantity = parseInt(quantityInput.value) || 1;\n const bookPrice = Number(currentBook.price) || 0;\n\n if (bookPrice <= 0) {\n  return showErrorMessage(\n   `\"${currentBook.title}\" isn't available right now.<br>Check back soon — we'll restock it ASAP!`\n  );\n }\n\n const bookId = currentBook._id;\n const itemTotalPrice = quantity * bookPrice;\n\n let cartArr = getLocalStorage(CARTKEY);\n const existingItemIndex = cartArr.findIndex(item => item.id === bookId);\n\n if (action === 'add-to-cart') {\n  if (existingItemIndex !== -1) {\n   cartArr.splice(existingItemIndex, 1);\n  }\n  \n  const newItem = {\n   id: bookId,\n   quantity,\n   price: bookPrice,\n   title: currentBook.title,\n  };\n  cartArr.push(newItem);\n  \n  setLocalStorage(CARTKEY, cartArr);\n  actionBtn.textContent = 'Remove from Cart';\n  actionBtn.dataset.action = 'remove-from-cart';\n  \n  const totalItems = cartArr.reduce((sum, item) => sum + (Number(item.quantity) || 0), 0);\n  const totalAmount = cartArr.reduce((sum, item) => sum + (Number(item.quantity) || 0) * (Number(item.price) || 0), 0);\n\n  showInfo(\n   `✅ You added <b>${quantity}</b> copies of \"<b>${\n    currentBook.title\n   }</b>\" to your cart for <b>$${itemTotalPrice.toFixed(2)}</b>.<br><br>\n   🛒 Cart total: <b>${totalItems}</b> items worth <b>$${totalAmount.toFixed(\n    2\n   )}</b>.`\n  );\n\n } else if (action === 'remove-from-cart') {\n  const updatedCart = cartArr.filter(item => item.id !== bookId);\n  setLocalStorage(CARTKEY, updatedCart);\n  actionBtn.textContent = 'Add to Cart';\n  actionBtn.dataset.action = 'add-to-cart';\n  quantityInput.value = 1;\n  \n  const quantityControl = actionBtn.closest('.modal-book-layout')?.querySelector('.quantity-control');\n  if (quantityControl) {\n   quantityControl.querySelector('.decrease-btn').disabled = true;\n  }\n  \n  showInfo(`🗑️ Book <b>\"${currentBook.title}\"</b> has been removed from your cart.`);\n\n } else if (action === 'buy-now') {\n  let itemsToPurchase = [];\n  const currentItem = { id: bookId, quantity, price: bookPrice, title: currentBook.title };\n  \n  if (existingItemIndex !== -1) {\n   cartArr.splice(existingItemIndex, 1, currentItem);\n   itemsToPurchase = cartArr;\n  } else {\n   itemsToPurchase = [...cartArr, currentItem];\n  }\n\n  const totalUniqueItems = new Set(itemsToPurchase.map(item => item.id)).size;\n  const totalItems = itemsToPurchase.reduce((sum, item) => sum + (Number(item.quantity) || 0), 0);\n  const totalAmount = itemsToPurchase.reduce((sum, item) => sum + (Number(item.quantity) || 0) * (Number(item.price) || 0), 0);\n\n  const bookText = totalItems === 1 ? 'book' : 'books';\n\n  showSuccess(\n   `🎉 You've successfully purchased <b>${totalUniqueItems}</b> unique titles (<b>${totalItems}</b> ${bookText} total) for <b>$${totalAmount.toFixed(2)}</b>. Thank you for your purchase!`\n  );\n\n  removeLocalStorage(CARTKEY); \n  \n  const cartActionBtn = actionBtn.closest('.modal-book-actions')?.querySelector('.add-to-cart-btn');\n  if (cartActionBtn) {\n   updateCartButtonState(cartActionBtn, bookId); \n  }\n  \n  quantityInput.value = 1;\n }\n}\n\nexport function showErrorMessage(message) {\n return iziToast.error({\n  title: '😔 Oops!',\n  message,\n  position: 'topRight',\n  timeout: 5000,\n  backgroundColor: '#ffcccc',\n  titleColor: '#000',\n  messageColor: '#000',\n  maxWidth: 480,\n });\n}\n\nexport function showInfo(message) {\n return iziToast.info({\n  title: '🛒 Cart Updated',\n  message,\n  position: 'topRight',\n  timeout: 5000,\n  backgroundColor: '#d9ecff',\n  titleColor: '#000',\n  messageColor: '#000',\n  maxWidth: 480,\n });\n}\n\nexport function showSuccess(message) {\n return iziToast.success({\n  title: '🎉 Purchase Successful!',\n  message,\n  position: 'topRight',\n  timeout: 5000,\n  backgroundColor: '#8a2be2',\n  titleColor: '#fff',\n  messageColor: '#fff',\n  maxWidth: 480,\n });\n}\n\nexport function showRegistrationSuccess(name, email) {\n return iziToast.success({\n  title: '🎉 Registration Successful!',\n  message: `Thank you for registering, ${name}! We will contact you at ${email}.`,\n  position: 'topRight',\n  timeout: 5000,\n  backgroundColor: '#28a745',\n  titleColor: '#fff',\n  messageColor: '#fff',\n  maxWidth: 480,\n });\n}","// src/js/render-functions.js\nimport { HTML_ESCAPE_MAP } from './constants.js';\nimport { showErrorMessage } from './cart';\n\nexport function escapeHtml(text) {\n  if (!text) return '';\n  return String(text).replace(/[&<>\"']/g, m => HTML_ESCAPE_MAP[m]);\n}\n\n/** Single book card */\nexport function createBookCard(book, index = 0) {\n  const li = document.createElement('li');\n  li.className = 'book-card';\n  li.style.animationDelay = `${(index % 8) * 0.05 + 0.1}s`;\n\n  const priceText = book.price && book.price !== '$0' ? book.price : '';\n\n  li.innerHTML = `\n    <div class=\"book-media\">\n      <img\n        class=\"book-cover loading\"\n        src=\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='227' height='323'%3E%3Crect width='100%25' height='100%25' fill='%23f0f0f0'/%3E%3C/svg%3E\"\n        ${book.image ? `data-src=\"${book.image}\"` : ''}\n        alt=\"${escapeHtml(book.title)}\"\n        loading=\"lazy\"\n      >\n    </div>\n    <div class=\"book-info\">\n        <h3 class=\"book-title\">${escapeHtml(book.title)}</h3>\n        <p class=\"book-author\">${escapeHtml(book.author)}</p>\n        ${\n          priceText\n            ? `<span class=\"book-price\">${escapeHtml(priceText)}</span>`\n            : ''\n        }\n    </div>\n    <div class=\"book-footer\">\n      <button\n        class=\"learn-more-btn\"\n        type=\"button\"\n        data-book-id=\"${escapeHtml(book.id)}\"\n        data-amazon-url=\"${escapeHtml(book.amazon_product_url)}\"\n      >\n        Learn More\n      </button>\n    </div>\n  `;\n  return li;\n}\n\nexport function createCategoryItem(name, value, isActive) {\n  return `\n    <li class=\"category-item ${\n      isActive ? 'active' : ''\n    }\" data-category=\"${escapeHtml(value)}\">\n      <button class=\"category-button\" type=\"button\" data-category=\"${escapeHtml(\n        value\n      )}\">\n        ${escapeHtml(name)}\n      </button>\n    </li>\n  `;\n}\n\nexport function renderCategories(\n  container,\n  categories,\n  activeCategory = 'all'\n) {\n  if (!container) return;\n  container.innerHTML = categories\n    .map(c => createCategoryItem(c.name, c.value, c.value === activeCategory))\n    .join('');\n}\n\nexport function populateDropdowns(\n  dropdowns,\n  categories,\n  activeCategory = 'all'\n) {\n  dropdowns.forEach(select => {\n    if (!select) return;\n    select.innerHTML = categories\n      .map(\n        c => `<option value=\"${escapeHtml(c.value)}\" ${\n          c.value === activeCategory ? 'selected' : ''\n        }>\n          ${escapeHtml(c.name)}\n        </option>`\n      )\n      .join('');\n  });\n}\n\n/** Books list renderers */\nexport function renderBooks(container, books) {\n  if (!container) return;\n  container.innerHTML = '';\n  if (!books || books.length === 0) {\n    showErrorMessage (\"Unfortunately, there are no books in this category right now\");\n    // container.innerHTML = `<li class=\"no-books\"><h3 class =\"text-no-books\">Unfortunately, there are no books in this category right now</h3></li>`;\n    return;\n  }\n  books.forEach((b, i) => {\n    const card = createBookCard(b, i);\n    container.appendChild(card);\n  });\n}\n\nexport function appendBooks(container, books) {\n  if (!container || !books?.length) return;\n  const start = container.children.length;\n  books.forEach((b, i) => {\n    const card = createBookCard(b, start + i);\n    container.appendChild(card);\n  });\n}\n\n/** UI helpers */\nexport function updateBooksCounter(counter, showing, total) {\n  if (counter) counter.textContent = `Showing ${showing} of ${total}`;\n}\n\nexport function updateShowMoreButton(button, hasMore, isLoading) {\n  if (!button) return;\n  const text = button.querySelector('.button-text');\n  if (!text) return;\n\n  if (isLoading) {\n    text.textContent = 'Loading...';\n    button.disabled = true;\n  } else if (hasMore) {\n    text.textContent = 'Show More';\n    button.disabled = false;\n    button.style.display = 'block';\n  } else {\n    button.style.display = 'none';\n  }\n}\n\nexport function showError(errorElement, message) {\n  if (!errorElement) return;\n  const messageElement = errorElement.querySelector('.error-message');\n  if (messageElement) messageElement.textContent = message;\n  errorElement.style.display = 'block';\n}\n\nexport function hideError(errorElement) {\n  if (errorElement) errorElement.style.display = 'none';\n}\n\nexport function setLoading(loader, listEl, isLoading) {\n  loader?.classList.toggle('hidden', !isLoading);\n  listEl?.setAttribute('aria-busy', String(isLoading));\n}\n\nexport function setCategoriesLoading(loader, isLoading) {\n  loader?.classList.toggle('hidden', !isLoading);\n}\n\nexport function updateCategoriesActiveState(container, activeCategory) {\n  if (!container) return;\n  container.querySelectorAll('.category-item').forEach(li => {\n    li.classList.toggle('active', li.dataset.category === activeCategory);\n  });\n}\n\nexport function createBookModalCard(book) {\n  const bookCard = document.createElement('div');\n  bookCard.className = 'modal-book-layout';\n\n  const priceDisplay =\n    book.price && book.price !== '0.00' ? book.price : '0.00';\n\n  const description =\n    book.description && book.description.trim() !== ''\n      ? book.description\n      : null;\n\n  const publisherText = book.publisher\n    ? `<br>Publisher: <b>${book.publisher}</b>.`\n    : null;\n\n  const weeksCount = book.weeks_on_list;\n  const weeksText = weeksCount === 1 ? 'week' : 'weeks';\n\n  const rankText =\n    book.rank && book.rank > 0 && weeksCount && weeksCount > 0\n      ? `<br>This book is ranked <b>#${book.rank}</b> on the bestseller list, having been on it for <b>${weeksCount}</b> ${weeksText}.`\n      : null;\n\n  let detailsContent = description || '';\n\n  if (description) {\n    let additionalInfo = '';\n    if (publisherText) additionalInfo += publisherText;\n    if (rankText) additionalInfo += rankText;\n\n    if (additionalInfo) {\n      detailsContent += additionalInfo;\n    }\n  }\n\n  if (!detailsContent) {\n    detailsContent = 'No description available for this book.';\n  }\n\n  bookCard.innerHTML = `\n        <img\n            class=\"book-cover-img\"\n            src=\"${book.book_image || ''}\"\n            alt=\"Book cover for '${book.title}' by ${book.author}\"\n            width=\"309\"\n            height=\"467\"\n        />\n\n        <div class=\"mobile-content\">\n            <div class=\"section-header\">\n                <h2 class=\"book-title-mobile\">${book.title}</h2>\n                <p class=\"book-author\">${book.author}</p>\n                <p class=\"price-mobile\">$${priceDisplay}</p>\n            </div>\n\n            <div class=\"quantity-control\" data-item-id=\"${book._id}\">\n                <button type=\"button\" class=\"decrease-btn\" aria-label=\"Decrease quantity\" disabled>-</button>\n                <input type=\"number\" class=\"quantity-input\" value=\"1\" min=\"1\" max=\"99\" aria-label=\"Book quantity\"/>\n                <button type=\"button\" class=\"increase-btn\" aria-label=\"Increase quantity\">+</button>\n            </div>\n\n            <div class=\"modal-book-actions\">\n                <button class=\"btn add-to-cart-btn\" type=\"button\" data-action=\"add-to-cart\">Add to Cart</button>\n                <button class=\"btn buy-now-btn btn-secondary\" type=\"button\" data-action=\"buy-now\">Buy Now</button>\n            </div>\n\n            <div class=\"accordion-container\">\n                <div class=\"ac\">\n                    <div class=\"ac-header\">\n                        <h4 class=\"ac-title\">Details</h4>\n                        <svg class=\"ac-icon arrow-down\" width=\"24\" height=\"25\">\n                            <use href=\"./assets/symbol-defs.svg#icon-chevron-down\" />\n                        </svg>\n                        <svg class=\"ac-icon arrow-up\" width=\"24\" height=\"25\">\n                            <use href=\"./assets/symbol-defs.svg#icon-chevron-up\" />\n                        </svg>\n                    </div>\n                    <div class=\"ac-panel\">\n                        <p class=\"ac-text\">${detailsContent}</p>\n                    </div>\n                </div>\n\n                <div class=\"ac\">\n                    <div class=\"ac-header\">\n                        <h4 class=\"ac-title\">Shipping</h4>\n                        <svg class=\"ac-icon arrow-down\" width=\"24\" height=\"25\">\n                            <use href=\"./assets/symbol-defs.svg#icon-chevron-down\" />\n                        </svg>\n                        <svg class=\"ac-icon arrow-up\" width=\"24\" height=\"25\">\n                            <use href=\"./assets/symbol-defs.svg#icon-chevron-up\" />\n                        </svg>\n                    </div>\n                    <div class=\"ac-panel\">\n                        <p class=\"ac-text\">\n                            We ship across the United States within 2-6 business days. All\n                            orders are processed through USPS or a reliable courier service. Enjoy free standard shipping on orders over $50.\n                        </p>\n                    </div>\n                </div>\n\n                <div class=\"ac\">\n                    <div class=\"ac-header\">\n                        <h4 class=\"ac-title\">Returns</h4>\n                        <svg class=\"ac-icon arrow-down\" width=\"24\" height=\"25\">\n                            <use href=\"./assets/symbol-defs.svg#icon-chevron-down\" />\n                        </svg>\n                        <svg class=\"ac-icon arrow-up\" width=\"24\" height=\"25\">\n                            <use href=\"./assets/symbol-defs.svg#icon-chevron-up\" />\n                        </svg>\n                    </div>\n                    <div class=\"ac-panel\">\n                        <p class=\"ac-text\">\n                            You can return an item within 14 days of receiving your order,\n                            provided it hasn't been used and is in its original condition.\n                            To start a return, please contact our support team — we'll guide \n                            you through the process quickly and hassle-free.\n                        </p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    `;\n  return bookCard;\n}\n","import Accordion from 'accordion-js';\nimport 'accordion-js/dist/accordion.min.css';\n\nimport refs from './refs.js';\nimport { createBookModalCard } from './render-functions.js';\nimport { \n handleQuantityChange, \n handleCartAction, \n updateCartButtonState \n} from './cart.js'; \n\nlet lastFocusedElement = null;\nlet scrollPosition = 0;\nlet currentBook = null;\n\nexport async function openBookModal(book) {\n if (!book || typeof book !== 'object') return;\n\n currentBook = book;\n lastFocusedElement = document.activeElement;\n const modal = refs.elBookModal;\n \n scrollPosition = window.scrollY;\n document.body.style.top = `-${scrollPosition}px`;\n document.body.style.position = 'fixed';\n document.body.style.width = '100%';\n document.body.style.overflow = 'hidden';\n\n refs.elModalContent.querySelectorAll('.modal-book-layout').forEach(el => el.remove());\n const bookCard = createBookModalCard(book);\n refs.elModalContent.appendChild(bookCard);\n \n const actionBtn = modal.querySelector('.add-to-cart-btn');\n if (actionBtn) {\n  updateCartButtonState(actionBtn, book._id); \n }\n\n modal.classList.add('active', 'is-open');\n modal.removeAttribute('inert');\n modal.setAttribute('aria-hidden', 'false');\n refs.elModalCloseBtn.focus({ preventScroll: true });\n\n refs.elBookModal.addEventListener('click', handleBookModal);\n window.addEventListener('keydown', handleEsc);\n\n const accordions = Array.from(refs.elModalContent.querySelectorAll('.accordion-container'));\n if (accordions.length > 0) {\n  new Accordion(accordions, {\n   duration: 300,\n   showMultiple: true,\n   triggerClass: 'ac-header',\n  });\n }\n}\n\nexport function closeBookModal() {\n const modal = refs.elBookModal;\n\n if (document.activeElement && modal.contains(document.activeElement)) {\n  document.activeElement.blur();\n }\n\n refs.elBookModal.removeEventListener('click', handleBookModal);\n window.removeEventListener('keydown', handleEsc);\n\n modal.classList.remove('active', 'is-open');\n modal.setAttribute('aria-hidden', 'true');\n modal.setAttribute('inert', '');\n\n setTimeout(() => {\n  document.body.style.position = '';\n  document.body.style.top = '';\n  document.body.style.overflow = '';\n  window.scrollTo({ top: scrollPosition, behavior: 'instant' });\n\n  if (lastFocusedElement) {\n   lastFocusedElement.focus();\n   lastFocusedElement = null;\n  }\n  currentBook = null;\n  refs.elModalContent.querySelectorAll('.modal-book-layout').forEach(el => el.remove());\n }, 300);\n}\n\nexport function handleBookModal(e) {\n if (e.target.closest('.modal-close-btn') || e.target === refs.elBookModal) {\n  return closeBookModal();\n }\n\n const targetBtn = e.target.closest('.decrease-btn') || e.target.closest('.increase-btn');\n if (targetBtn) {\n  return handleQuantityChange(targetBtn);\n }\n\n const actionBtn = e.target.closest('[data-action]');\n if (actionBtn && currentBook) {\n  handleCartAction(actionBtn, currentBook);\n }\n}\n\nexport function handleEsc(e) {\n if (e.key === 'Escape') {\n  return closeBookModal();\n }\n}","\n// -----footer-----\nexport function validateEmail(email) {\n  return /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email);\n}\n// -----footer-end-----","import refs from './refs.js';\nimport { getBookById } from './api-service';\nimport { openBookModal } from './modal-book';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { validateEmail } from './helpers.js';\nimport { TOAST_DELAY, MESSAGES } from './constants.js';\nimport { saveEmailToLocal } from './storage.js';\n\nexport function createShowMoreHandler(section) {\n  return () => section.loadMore();\n}\n\nexport function createBookClickHandler() {\n  return async function handler(e) {\n    const btn = e.target.closest('.learn-more-btn');\n    if (!btn) return;\n    e.preventDefault();\n\n    const bookId = btn.dataset.bookId;\n    if (!bookId || bookId === 'no-id') return;\n\n    try {\n      const bookData = await getBookById(bookId);\n      openBookModal(bookData);\n    } catch (error) {\n      showError(\n        this.elements.errorElement,\n        `Error fetching book: ${error.message}`\n      );\n    }\n  };\n}\n\nexport function createResizeHandler(section) {\n  return () => {\n    if (section.debounceTimeout) clearTimeout(section.debounceTimeout);\n    section.debounceTimeout = setTimeout(() => {\n      const cards =\n        section.elements.booksGrid?.querySelectorAll('.book-card') ?? [];\n      cards.forEach(\n        (card, i) => (card.style.animationDelay = `${(i % 8) * 0.05 + 0.1}s`)\n      );\n    }, 250);\n  };\n}\n\nexport function createCategoryChangeHandler(section) {\n  return e => section.filterByCategory(e.target.value);\n}\n\nexport function createCategoryButtonHandler(section) {\n  return e => {\n    const li = e.currentTarget.closest('.category-item');\n    const cat = li?.dataset.category;\n    if (cat && cat !== section.currentCategory) section.filterByCategory(cat);\n  };\n}\n\nexport function createRetryHandler(section) {\n  return () => section.loadBooks(true);\n}\n\nexport function createIntersectionObserver(onLoad) {\n  return new IntersectionObserver(\n    entries => {\n      entries.forEach(entry => {\n        if (entry.isIntersecting) onLoad(entry.target);\n      });\n    },\n    { rootMargin: '50px 0px' }\n  );\n}\n\nexport function loadImage(img, observer) {\n  const src = img.dataset.src;\n  if (!src) return;\n  img.classList.add('loading');\n  const t = new Image();\n  t.onload = () => {\n    img.src = src;\n    img.classList.remove('loading');\n    img.classList.add('loaded');\n    delete img.dataset.src;\n    observer?.unobserve(img);\n  };\n  t.onerror = () => {\n    img.classList.remove('loading');\n    img.classList.add('error');\n    observer?.unobserve(img);\n  };\n  t.src = src;\n}\n\n// -----footer-----\nfunction showToast(type, title, message) {\n  iziToast[type]({\n    title,\n    message,\n    position: 'topRight',\n  });\n}\n\nexport function onFooterSubmit(e) {\n  e.preventDefault();\n\n  const email = refs.footerInput.value.trim();\n\n  refs.footerBtn.classList.remove('btn-error', 'btn-success');\n  refs.footerRemark.classList.remove('remark-error', 'remark-success');\n  refs.footerInput.classList.remove('error', 'success');\n\n  if (!email) {\n    refs.footerRemark.textContent = MESSAGES.REQUIRED;\n    refs.footerRemark.classList.add('remark-error');\n    refs.footerInput.classList.add('error');\n    showToast('warning', 'Caution', MESSAGES.REQUIRED);\n    setTimeout(clearFormState, TOAST_DELAY);\n    return;\n  }\n\n  if (!validateEmail(email)) {\n    refs.footerRemark.textContent = MESSAGES.INVALID;\n    refs.footerRemark.classList.add('remark-error');\n    refs.footerBtn.classList.add('btn-error');\n    refs.footerInput.classList.add('error');\n    showToast('error', 'Error', MESSAGES.INVALID);\n    setTimeout(clearFormState, TOAST_DELAY);\n    return;\n  }\n\n  refs.footerRemark.textContent = '✅ ' + MESSAGES.SUCCESS;\n  refs.footerRemark.classList.add('remark-success');\n  refs.footerBtn.classList.add('btn-success');\n  refs.footerInput.classList.add('success');\n  showToast('success', 'OK', MESSAGES.SUCCESS);\n\n  saveEmailToLocal(email);\n\n  setTimeout(clearFormState, TOAST_DELAY);\n  refs.footerForm.reset();\n}\n\nfunction clearFormState() {\n  refs.footerRemark.textContent = '';\n  refs.footerRemark.classList.remove('remark-error', 'remark-success');\n  refs.footerBtn.classList.remove('btn-error', 'btn-success');\n  refs.footerInput.classList.remove('error', 'success');\n}\n// -----footer-end-----\n\n//-----modal-book----\n","// src/js/books-data.js\nimport { api } from './api-service.js';\nimport { DOM_ELEMENTS, BOOKS_CONFIG } from './constants.js';\nimport {\n  renderCategories,\n  populateDropdowns,\n  renderBooks,\n  appendBooks,\n  updateBooksCounter,\n  updateShowMoreButton,\n  showError,\n  hideError,\n  setLoading,\n  setCategoriesLoading,\n  updateCategoriesActiveState,\n} from './render-functions.js';\nimport {\n  createShowMoreHandler,\n  createBookClickHandler,\n  createResizeHandler,\n  createCategoryChangeHandler,\n  createCategoryButtonHandler,\n  createRetryHandler,\n  createIntersectionObserver,\n  loadImage,\n} from './handlers.js';\n\n/* ----------------------------- UI-level dedupe ----------------------------- */\nfunction norm(s) {\n  return String(s || '')\n    .toLowerCase()\n    .replace(/&amp;/g, '&')\n    .replace(/\\s+/g, ' ')\n    .replace(/[^\\p{L}\\p{N}\\s]/gu, '')\n    .trim();\n}\n\nfunction keyTA(b) {\n  const t = norm(b.title);\n  const a = norm(b.author);\n  return t || a ? `ta:${t}|${a}` : `id:${b.id || 'no-id'}`;\n}\n\nfunction dedupeForUI(list = []) {\n  const seen = new Set();\n  const out = [];\n  for (const b of list) {\n    const k = keyTA(b);\n    if (seen.has(k)) continue;\n    seen.add(k);\n    out.push(b);\n  }\n  return out;\n}\n\n/**\n * Merge `existing` with `candidates` and take at most `takeCount` NEW unique items\n * (unique by title+author). Returns { merged, newItems }.\n */\nfunction mergeTakeNew(existing, candidates, takeCount) {\n  const seen = new Set(existing.map(keyTA));\n  const merged = existing.slice();\n  const newItems = [];\n  for (const b of candidates) {\n    const k = keyTA(b);\n    if (seen.has(k)) continue;\n    seen.add(k);\n    merged.push(b);\n    newItems.push(b);\n    if (newItems.length >= takeCount) break;\n  }\n  return { merged, newItems };\n}\n\n/* --------------------------------- Class ---------------------------------- */\nclass BooksSection {\n  constructor() {\n    this.elements = {\n      booksGrid: document.getElementById(DOM_ELEMENTS.booksGrid),\n      booksLoader: document.getElementById(DOM_ELEMENTS.booksLoader),\n      showMoreBtn: document.getElementById(DOM_ELEMENTS.showMoreBtn),\n      categoriesUL: document.getElementById(DOM_ELEMENTS.categoriesList),\n      categoriesLoader: document.getElementById(DOM_ELEMENTS.categoriesLoader),\n      errorElement: document.getElementById(DOM_ELEMENTS.booksError),\n      booksCounter: document.getElementById(DOM_ELEMENTS.booksCounter),\n      categoriesSelectTablet: document.getElementById(\n        DOM_ELEMENTS.categoriesSelectTablet\n      ),\n      categoriesSelectMobile: document.getElementById(\n        DOM_ELEMENTS.categoriesSelectMobile\n      ),\n    };\n\n    this.currentCategory = 'all';\n    this.currentPage = 1;\n    this.isLoading = false;\n    this.hasMore = true;\n    this.loadedBooks = [];\n\n    this.imageObserver = null;\n    this.debounceTimeout = null;\n\n    this.initialCount = this.getInitialBooksCount();\n    this.init();\n  }\n\n  async init() {\n    try {\n      hideError(this.elements.errorElement);\n      this.setupEventListeners();\n      this.setupObservers();\n      await this.renderCategories();\n      await this.loadBooks(true);\n    } catch (e) {\n      console.error('Books init error:', e);\n      showError(\n        this.elements.errorElement,\n        'Failed to load books. Please try again.'\n      );\n    }\n  }\n\n  setupEventListeners() {\n    this.elements.showMoreBtn?.addEventListener(\n      'click',\n      createShowMoreHandler(this)\n    );\n    this.elements.booksGrid?.addEventListener(\n      'click',\n      createBookClickHandler()\n    );\n    window.addEventListener('resize', createResizeHandler(this));\n    this.elements.categoriesSelectTablet?.addEventListener(\n      'change',\n      createCategoryChangeHandler(this)\n    );\n    this.elements.categoriesSelectMobile?.addEventListener(\n      'change',\n      createCategoryChangeHandler(this)\n    );\n    this.elements.errorElement\n      ?.querySelector('.retry-btn')\n      ?.addEventListener('click', createRetryHandler(this));\n  }\n\n  setupObservers() {\n    if ('IntersectionObserver' in window) {\n      this.imageObserver = createIntersectionObserver(img =>\n        loadImage(img, this.imageObserver)\n      );\n    }\n  }\n\n  async renderCategories() {\n    if (!this.elements.categoriesUL) return;\n    setCategoriesLoading(this.elements.categoriesLoader, true);\n    try {\n      const categories = await api.getCategories();\n      renderCategories(\n        this.elements.categoriesUL,\n        categories,\n        this.currentCategory\n      );\n      this.elements.categoriesUL\n        .querySelectorAll('.category-button')\n        .forEach(btn =>\n          btn.addEventListener('click', createCategoryButtonHandler(this))\n        );\n      populateDropdowns(\n        [\n          this.elements.categoriesSelectTablet,\n          this.elements.categoriesSelectMobile,\n        ],\n        categories,\n        this.currentCategory\n      );\n    } finally {\n      setCategoriesLoading(this.elements.categoriesLoader, false);\n    }\n  }\n\n  async loadBooks(reset = false) {\n    if (this.isLoading) return;\n    this.setLoading(true);\n    hideError(this.elements.errorElement);\n    try {\n      const limit = reset\n        ? this.getInitialBooksCount()\n        : window.innerWidth <= BOOKS_CONFIG.mobileBreakpoint\n        ? BOOKS_CONFIG.perLoadMoreMobile\n        : BOOKS_CONFIG.perLoadMoreDesktop;\n      const page = reset ? 1 : this.currentPage + 1;\n      const data = await api.getBooks(this.currentCategory, page, limit);\n\n      if (reset) {\n        this.loadedBooks = [...data.books];\n        this.currentPage = 1;\n        renderBooks(this.elements.booksGrid, this.loadedBooks);\n      } else {\n        this.loadedBooks.push(...data.books);\n        this.currentPage = page;\n        appendBooks(this.elements.booksGrid, data.books);\n      }\n\n      this.setupLazyLoading();\n\n      const total =\n        typeof data.total === 'number'\n          ? data.total\n          : dedupeForUI(this.loadedBooks).length;\n\n      // hasMore if server still has items AND we still didn't hit total\n      this.hasMore = Boolean(data.hasMore) && this.loadedBooks.length < total;\n\n      this.updateShowMoreButton();\n      updateBooksCounter(\n        this.elements.booksCounter,\n        this.loadedBooks.length,\n        total\n      );\n    } catch (e) {\n      console.error('Load books error:', e);\n      showError(\n        this.elements.errorElement,\n        `Failed to load books: ${e.message}`\n      );\n    } finally {\n      this.setLoading(false);\n    }\n  }\n\n  setupLazyLoading() {\n    if (!this.imageObserver) return;\n    this.elements.booksGrid\n      ?.querySelectorAll('.book-cover[data-src]')\n      .forEach(img => this.imageObserver.observe(img));\n  }\n\n  async filterByCategory(category) {\n    if (category === this.currentCategory) return;\n\n    this.currentCategory = category;\n    this.currentPage = 1;\n    this.loadedBooks = [];\n\n    updateCategoriesActiveState(this.elements.categoriesUL, category);\n    if (this.elements.categoriesSelectTablet)\n      this.elements.categoriesSelectTablet.value = category;\n    if (this.elements.categoriesSelectMobile)\n      this.elements.categoriesSelectMobile.value = category;\n    await this.loadBooks(true);\n  }\n\n  async loadMore() {\n    if (!this.hasMore || this.isLoading) return;\n    await this.loadBooks(false);\n  }\n  updateShowMoreButton() {\n    updateShowMoreButton(\n      this.elements.showMoreBtn,\n      this.hasMore,\n      this.isLoading\n    );\n  }\n  getInitialBooksCount() {\n    return window.innerWidth <= BOOKS_CONFIG.mobileBreakpoint\n      ? BOOKS_CONFIG.initialPerPageMobile\n      : BOOKS_CONFIG.initialPerPageDesktop;\n  }\n  setLoading(v) {\n    this.isLoading = v;\n    setLoading(this.elements.booksLoader, this.elements.booksGrid, v);\n    this.updateShowMoreButton();\n  }\n  destroy() {\n    this.imageObserver?.disconnect();\n    if (this.debounceTimeout) clearTimeout(this.debounceTimeout);\n  }\n}\n\nexport default BooksSection;\n","import BooksSection from './books-data.js';\n\n// Keep a single instance across HMR & repeated imports\nlet instance = window.__booksSectionInstance || null;\n\nexport function mountBooks() {\n  if (instance) return instance;\n  instance = new BooksSection();\n  window.__booksSectionInstance = instance;\n  return instance;\n}\n\n// Auto–mount exactly once\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', () => mountBooks(), { once: true });\n} else {\n  mountBooks();\n}\n\n// Clean up on Vite HMR to avoid duplicated mounts\nif (import.meta?.hot) {\n  import.meta.hot.dispose(() => {\n    if (instance) {\n      instance.destroy?.();\n      instance = null;\n      window.__booksSectionInstance = null;\n    }\n  });\n}\n\n\n","import {showRegistrationSuccess} from './cart'\nconst modalBackdrop = document.getElementById('modal');\nconst modal = modalBackdrop.querySelector('.modal-content');\nconst modalEventTitle = document.getElementById('modal-event-title');\nconst openButtons = document.querySelectorAll('.open-modal-btn, #open-contact');\nconst closeButtons = modalBackdrop.querySelectorAll('.modal-close-btn');\nconst form = document.querySelector('.register-form');\n\n\nlet lastFocusedEl = null;\n\n\nconst htmlElement = document.documentElement;\nlet handleKeydownRef = null;     \nlet handleBackdropClickRef = null;\n\n//   POTENTIAL PROBLEM\n\nfunction openModal(eventTitle, opener) {\n  lastFocusedEl = opener || document.activeElement;\n  modalBackdrop.classList.add('active');\n  \n  document.body.classList.add('modal-open');\n  htmlElement.classList.add('modal-open'); \n\n  const firstInput = modal.querySelector('input, textarea, button');\n  firstInput && firstInput.focus();\n\n  handleKeydownRef = function(e) {\n      if (e.key === 'Escape') {\n          closeModal();\n      }\n    \n      if (e.key === 'Tab') {\n          trapTabKey(e);\n      }\n  }\n\n  handleBackdropClickRef = function(e) {\n      if (e.target === modalBackdrop) {\n          closeModal();\n      }\n  }\n  \n  document.addEventListener('keydown', handleKeydownRef);\n  modalBackdrop.addEventListener('click', handleBackdropClickRef);\n}\n\nfunction closeModal() {\n  modalBackdrop.classList.remove('active');\n\n  if (handleKeydownRef) {\n      document.removeEventListener('keydown', handleKeydownRef);\n  }\n  if (handleBackdropClickRef) {\n      modalBackdrop.removeEventListener('click', handleBackdropClickRef);\n  }\n\n  document.body.classList.remove('modal-open');\n  htmlElement.classList.remove('modal-open'); \n\n  lastFocusedEl && lastFocusedEl.focus();\n  \n  handleKeydownRef = null;\n  handleBackdropClickRef = null;\n}\n\nopenButtons.forEach(btn => {\n  btn.addEventListener('click', e => {\n    const title = btn.dataset.eventTitle;\n    modalEventTitle.textContent = title;\n    btn.getAttribute('data-event-title');\n    openModal(title, btn);\n  });\n});\n\n\n\ncloseButtons.forEach(b => b.addEventListener('click', closeModal));\n\nfunction trapTabKey(e) {\n  const focusable = modal.querySelectorAll(\n    'a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex=\"-1\"])'\n  );\n  if (!focusable.length) return;\n  const first = focusable[0];\n  const last = focusable[focusable.length - 1];\n  if (e.shiftKey && document.activeElement === first) {\n    last.focus();\n    e.preventDefault();\n  } else if (!e.shiftKey && document.activeElement === last) {\n    first.focus();\n    e.preventDefault();\n  }\n}\n\nform.addEventListener('submit', e => {\n  e.preventDefault();\n  if (!form.checkValidity()) {\n   \n    const invalid = form.querySelector(':invalid');\n    if (invalid) invalid.focus();\n    return;\n  }\n\n  const name = form.name.value;\n  const email = form.email.value;\n  console.log('Submitted:', { name, email, message: form.message.value });\n  closeModal();\n  showRegistrationSuccess(`Thank you for registering, ${name}! We will contact you at ${email}.`);\n  form.reset();\n});\n \n","import Swiper from 'swiper';\nimport 'swiper/css';\nimport 'swiper/css/navigation';\nimport 'swiper/css/pagination';\nimport {\n  Navigation,\n  Pagination,\n  A11y,\n  Keyboard,\n  Mousewheel,\n} from 'swiper/modules';\n\nSwiper.use([Navigation, Pagination, A11y, Keyboard, Mousewheel]);\n\nconst swiperElement = document.querySelector('.events-slider');\nconst eventSlider = new Swiper(swiperElement, {\n  slidesPerView: 1,\n  spaceBetween: 24,\n  watchOverflow: true,\n\n  navigation: {\n    nextEl: '.events-section .swiper-button-next',\n    prevEl: '.events-section .swiper-button-prev',\n  },\n  pagination: {\n    el: '.events-section .swiper-pagination',\n    clickable: true,\n  },\n  a11y: {\n    enabled: true,\n  },\n  keyboard: {\n    enabled: true,\n  },\n  mousewheel: {\n    enabled: true,\n    forceToAxis: true,\n  },\n\n  breakpoints: {\n    320: {\n      slidesPerView: 1,\n    },\n    768: {\n      slidesPerView: 2,\n    },\n    1440: {\n      slidesPerView: 3,\n    },\n  },\n});\n","import refs  from './refs.js';\nimport { onFooterSubmit } from './handlers.js';\n\nrefs.footerForm.addEventListener('submit', onFooterSubmit);\n\n","const scrollBtn = document.querySelector('.scroll-top');\nconst scrollTriggerPoint = document.querySelector('.hero');\n\nfunction handleIntersection(entries) {\n  entries.forEach(entry => {\n    if (entry.isIntersecting) {\n      scrollBtn.classList.add('hidden');\n    } else {\n      scrollBtn.classList.remove('hidden');\n    }\n  });\n}\n\nconst observer = new IntersectionObserver(handleIntersection);\nobserver.observe(scrollTriggerPoint);\n\nfunction scrollToTop() {\n  window.scrollTo({\n    top: 0,\n    behavior: 'smooth',\n  });\n}\n\nscrollBtn.addEventListener('click', scrollToTop);\n"],"names":["refs","closeNavbar","Swiper","Navigation","Pagination","A11y","Keyboard","Mousewheel","swiperElement","swiper","nextBtn","prevBtn","updateButtons","BOOKS_BASE_URL","REQUEST_TIMEOUT","RETRY_ATTEMPTS","RETRY_DELAY","BOOKS_CONFIG","CACHE_CONFIG","FALLBACK_CATEGORIES","DOM_ELEMENTS","HTML_ESCAPE_MAP","STORAGE_KEYS","TOAST_DELAY","MESSAGES","CARTKEY","fetchJSON","path","options","controller","timeoutId","lastError","attempt","res","txt","err","r","normalizeBook","book","fallbackImage","MemoryCache","maxSize","ttl","key","value","first","item","BooksAPI","cached","data","categories","c","n","result","category","page","limit","k","endpoint","allBooks","seen","list","_a","start","end","e","api","getBookById","id","axios","error","saveEmailToLocal","email","emails","setLocalStorage","array","getLocalStorage","removeLocalStorage","isBookInCart","bookId","updateCartButtonState","actionBtn","handleQuantityChange","targetBtn","quantityControl","input","min","max","handleCartAction","currentBook","action","quantityInput","quantity","bookPrice","showErrorMessage","itemTotalPrice","cartArr","existingItemIndex","newItem","totalItems","sum","totalAmount","showInfo","updatedCart","itemsToPurchase","currentItem","totalUniqueItems","showSuccess","cartActionBtn","_b","message","iziToast","showRegistrationSuccess","name","escapeHtml","text","m","createBookCard","index","li","priceText","createCategoryItem","isActive","renderCategories","container","activeCategory","populateDropdowns","dropdowns","select","renderBooks","books","b","i","card","appendBooks","updateBooksCounter","counter","showing","total","updateShowMoreButton","button","hasMore","isLoading","showError","errorElement","messageElement","hideError","setLoading","loader","listEl","setCategoriesLoading","updateCategoriesActiveState","createBookModalCard","bookCard","priceDisplay","description","publisherText","weeksCount","weeksText","rankText","detailsContent","additionalInfo","lastFocusedElement","scrollPosition","openBookModal","modal","el","handleBookModal","handleEsc","accordions","Accordion","closeBookModal","validateEmail","createShowMoreHandler","section","createBookClickHandler","btn","bookData","createResizeHandler","createCategoryChangeHandler","createCategoryButtonHandler","cat","createRetryHandler","createIntersectionObserver","onLoad","entries","entry","loadImage","img","observer","src","t","showToast","type","title","onFooterSubmit","clearFormState","norm","s","keyTA","a","dedupeForUI","out","BooksSection","_c","_d","_f","_e","reset","v","instance","mountBooks","modalBackdrop","modalEventTitle","openButtons","closeButtons","form","lastFocusedEl","htmlElement","handleKeydownRef","handleBackdropClickRef","openModal","eventTitle","opener","firstInput","closeModal","trapTabKey","focusable","last","invalid","scrollBtn","scrollTriggerPoint","handleIntersection","scrollToTop"],"mappings":"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"}