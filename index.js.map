{"version":3,"file":"index.js","sources":["../src/js/burger-menu.js","../src/js/slider-feedbacks.js","../src/js/slider-hero.js","../src/js/constants.js","../src/js/api-service.js","../src/js/refs.js","../src/js/render-functions.js","../src/js/modal-book.js","../src/js/handlers.js","../src/js/books-data.js","../src/js/books.js"],"sourcesContent":["const navbar = document.querySelector('[data-navbar]');\r\nconst burgerOpen = document\r\n  .querySelector('[data-navbar-open]')\r\n  .addEventListener('click', () => {\r\n    navbar.classList.remove('is-close');\r\n    navbar.classList.add('is-open');\r\n    document.body.classList.add('no-scroll');\r\n  });\r\n\r\nconst burgerClose = document\r\n  .querySelector('[data-navbar-close]')\r\n  .addEventListener('click', () => {\r\n    navbar.classList.replace('is-open', 'is-close');\r\n    document.body.classList.remove('no-scroll');\r\n  });\r\n","import Swiper from 'swiper';\nimport 'swiper/css';\nimport 'swiper/css/navigation';\nimport 'swiper/css/pagination';\nimport {\n  Navigation,\n  Pagination,\n  A11y,\n  Keyboard,\n  Mousewheel,\n} from 'swiper/modules';\n\nSwiper.use([Navigation, Pagination, A11y, Keyboard, Mousewheel]);\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  const swiperElement = document.querySelector('.feedbacks-slider');\n\n  if (!swiperElement) {\n    console.error('Swiper: Контейнер .feedbacks-slider не знайдено.');\n    return;\n  }\n\n  const swiper = new Swiper(swiperElement, {\n    slidesPerView: 1,\n    spaceBetween: 24,\n    watchOverflow: true,\n\n    navigation: {\n      nextEl: '.swiper-arrows .swiper-button-next',\n      prevEl: '.swiper-arrows .swiper-button-prev',\n    },\n    pagination: {\n      el: '.carousel-navigation .swiper-pagination',\n      clickable: true,\n    },\n    a11y: {\n      enabled: true,\n    },\n    keyboard: {\n      enabled: true,\n    },\n    mousewheel: {\n      enabled: true,\n      forceToAxis: true,\n    },\n\n    breakpoints: {\n      320: {\n        slidesPerView: 1,\n        spaceBetween: 24,\n      },\n      768: {\n        slidesPerView: 2,\n        spaceBetween: 32,\n      },\n      1440: {\n        slidesPerView: 3,\n        spaceBetween: 32,\n      },\n    },\n  });\n});\n","import Swiper from 'swiper/bundle';\nimport 'swiper/css/bundle';\n\nconst swiper = new Swiper('.heroSwiper', {\n  spaceBetween: 5,\n  speed: 500,\n  navigation: {\n    nextEl: '.swiper-button-next',\n    prevEl: '.swiper-button-prev',\n  },\n  keyboard: true,\n});\n\nconst next = document.querySelector('.button-next');\nconst prev = document.querySelector('.button-prev');\n\nnext.addEventListener('click', () => {\n  console.log('next');\n  swiper.slideNext();\n});\n\nprev.addEventListener('click', () => {\n  console.log('prev');\n  swiper.slidePrev();\n});\n","\nexport const BOOKS_BASE_URL = 'https://books-backend.p.goit.global';\nexport const REQUEST_TIMEOUT = 10000;\nexport const RETRY_ATTEMPTS = 3;\nexport const RETRY_DELAY = 1000;\n\n// UI/логіка\nexport const BOOKS_CONFIG = {\n  initialPerPageMobile: 10,\n  initialPerPageDesktop: 24,\n  perLoadMoreDesktop: 24,\n  perLoadMoreMobile: 10,\n  mobileBreakpoint: 768,\n  tabletBreakpoint: 1024,\n};\n\n// Cache\nexport const CACHE_CONFIG = {\n  maxSize: 50,\n  ttl: 5 * 60 * 1000,\n};\n\n// Фолбек-категорії\nexport const FALLBACK_CATEGORIES = [\n  'Hardcover Fiction','Hardcover Nonfiction','Trade Fiction Paperback','Mass Market Monthly',\n  'Paperback Trade Fiction','Paperback Nonfiction','E-Book Fiction','E-Book Nonfiction',\n  'Hardcover Advice','Paperback Advice','Advice How-To and Miscellaneous',\n  \"Children's Middle Grade Hardcover\",'Picture Books','Series Books','Young Adult Hardcover',\n  'Audio Fiction','Audio Nonfiction','Business Books','Graphic Books and Manga',\n  'Mass Market','Middle Grade Paperback','Young Adult Paperback',\n];\n\n// ID елементів у DOM\nexport const DOM_ELEMENTS = {\n  booksGrid: 'books-grid',\n  booksLoader: 'books-loader',\n  showMoreBtn: 'show-more-btn',\n  categoriesList: 'categories-list',\n  categoriesLoader: 'categories-loader',\n  booksError: 'books-error',\n  booksCounter: 'books-counter-text',\n  categoriesSelectTablet: 'categories-select-tablet',\n  categoriesSelectMobile: 'categories-select-mobile',\n};\n\n// для екранування\nexport const HTML_ESCAPE_MAP = { '&':'&amp;','<':'&lt;','>':'&gt;','\"':'&quot;',\"'\":'&#039;' };\n\n// -----footer-----\nexport const STORAGE_KEYS = {\n  EMAILS: 'emails',\n};\n\nexport const TOAST_DELAY = 3000;\n\nexport const MESSAGES = {\n  REQUIRED: '* Required field',\n  INVALID: 'Please enter a valid email',\n  SUCCESS: 'Email saved!',\n};\n// -----footer-end-----","import {\n  BOOKS_BASE_URL,\n  REQUEST_TIMEOUT,\n  RETRY_ATTEMPTS,\n  RETRY_DELAY,\n  FALLBACK_CATEGORIES,\n  CACHE_CONFIG,\n} from './constants.js';\n\nimport axios from 'axios';\n\n/* -------------------------- exports -------------------------- */\nexport { fetchJSON, normalizeBook, api };\n\n/* -------------------------- fetch helpers -------------------------- */\nasync function fetchJSON(path, options = {}) {\n  const controller = new AbortController();\n  const timeoutId = setTimeout(() => controller.abort(), REQUEST_TIMEOUT);\n  let lastError = null;\n\n  for (let attempt = 1; attempt <= RETRY_ATTEMPTS; attempt++) {\n    try {\n      const res = await fetch(`${BOOKS_BASE_URL}${path}`, {\n        signal: controller.signal,\n        headers: {\n          'Content-Type': 'application/json',\n          Accept: 'application/json',\n        },\n        ...options,\n      });\n      clearTimeout(timeoutId);\n\n      if (!res.ok) {\n        const txt = await res.text().catch(() => '');\n        throw new Error(`API ${res.status}: ${res.statusText}. ${txt}`);\n      }\n      return await res.json();\n    } catch (err) {\n      lastError = err;\n      if (err.name === 'AbortError')\n        throw new Error('Request timeout. Please check your connection.');\n      if (attempt === RETRY_ATTEMPTS) throw lastError;\n      await new Promise(r => setTimeout(r, RETRY_DELAY * attempt));\n    }\n  }\n}\n\n/* -------------------------- normalization -------------------------- */\nfunction normalizeBook(book, fallbackImage = '') {\n  return {\n    id: book._id || 'no-id',\n    title: book.title || 'Untitled',\n    author: book.author || 'Unknown Author',\n    image: book.book_image || fallbackImage,\n    amazon_product_url: book.amazon_product_url || '#',\n    price: book.price || '',\n  };\n}\n\n/* -------------------------- canonization -------------------------- */\nfunction canon(s) {\n  return String(s || '')\n    .toLowerCase()\n    .normalize('NFKD')\n    .replace(/[\\u0300-\\u036f]/g, '')\n    .replace(/&amp;/g, '&')\n    .replace(/\\s+/g, ' ')\n    .replace(/[^\\p{L}\\p{N}\\s]/gu, '')\n    .trim();\n}\n\n/* -------------------------- deduplication -------------------------- */\nfunction dedupeStable(list) {\n  const out = [];\n  const byId = new Set();\n  const byTA = new Set();\n\n  for (const b of list) {\n    if (b?.id && b.id !== 'no-id') {\n      const k = `id:${b.id}`;\n      if (byId.has(k)) continue;\n      byId.add(k);\n      const ta = `ta:${canon(b.title)}|${canon(b.author)}`;\n      byTA.add(ta);\n      out.push(b);\n      continue;\n    }\n\n    const ta = `ta:${canon(b.title)}|${canon(b.author)}`;\n    if (byTA.has(ta)) continue;\n    byTA.add(ta);\n    out.push(b);\n  }\n\n  return out;\n}\n\n/* ------------------------------ cache ------------------------------ */\nclass MemoryCache {\n  constructor(maxSize = CACHE_CONFIG.maxSize, ttl = CACHE_CONFIG.ttl) {\n    this.cache = new Map();\n    this.maxSize = maxSize;\n    this.ttl = ttl;\n  }\n  set(key, value) {\n    if (this.cache.size >= this.maxSize) {\n      const first = this.cache.keys().next().value;\n      this.cache.delete(first);\n    }\n    this.cache.set(key, { value, ts: Date.now() });\n  }\n  get(key) {\n    const item = this.cache.get(key);\n    if (!item) return null;\n    if (Date.now() - item.ts > this.ttl) {\n      this.cache.delete(key);\n      return null;\n    }\n    return item.value;\n  }\n  clear() {\n    this.cache.clear();\n  }\n}\n\n/* ------------------------------- API -------------------------------- */\nclass BooksAPI {\n  constructor() {\n    this.cache = new MemoryCache();\n  }\n\n  async getCategories() {\n    const key = 'categories';\n    const cached = this.cache.get(key);\n    if (cached) return cached;\n\n    try {\n      const data = await fetchJSON('/books/category-list');\n      let categories = [];\n\n      if (data && Array.isArray(data.results)) {\n        categories = data.results\n          .map(c => {\n            if (typeof c === 'object' && c.list_name)\n              return { name: c.list_name, value: c.list_name };\n            if (typeof c === 'string') return { name: c, value: c };\n            return null;\n          })\n          .filter(Boolean);\n      }\n      if (!categories.length)\n        categories = FALLBACK_CATEGORIES.map(n => ({ name: n, value: n }));\n      const result = [{ name: 'All Categories', value: 'all' }, ...categories];\n      this.cache.set(key, result); // Виправлено: k на key\n      return result;\n    } catch {\n      return [\n        { name: 'All Categories', value: 'all' },\n        ...FALLBACK_CATEGORIES.map(n => ({ name: n, value: n })),\n      ];\n    }\n  }\n\n  async getBooks(category = 'all', page = 1, limit) {\n    if (!limit) {\n      limit = window.innerWidth <= 768 ? 10 : 24;\n    }\n\n    const k = `books_${category}_${page}_${limit}`;\n    const cached = this.cache.get(k);\n    if (cached) return cached;\n\n    try {\n      let endpoint = '/books/top-books';\n      if (category !== 'all') {\n        endpoint = `/books/category?category=${encodeURIComponent(category)}`;\n      }\n\n      const data = await fetchJSON(endpoint);\n      const allBooks = [];\n      const seen = new Set();\n\n      if (category === 'all') {\n        if (Array.isArray(data)) {\n          data.forEach(list => {\n            if (Array.isArray(list.books)) {\n              list.books.forEach(b => {\n                const book = normalizeBook(b);\n                const key = `${book.title}__${book.image}`;\n                if (!seen.has(key)) {\n                  seen.add(key);\n                  allBooks.push(book);\n                }\n              });\n            }\n          });\n        }\n      } else {\n        const booksArray = data?.results?.length\n          ? data.results\n          : Array.isArray(data)\n          ? data\n          : [];\n        booksArray.forEach(b => {\n          const book = normalizeBook(b);\n          const key = `${book.title}__${book.image}`;\n          if (!seen.has(key)) {\n            seen.add(key);\n            allBooks.push(book);\n          }\n        });\n      }\n\n      if (!allBooks.length) {\n        console.log(`У категорії \"${category}\" немає книг.`);\n      }\n\n      const start = (page - 1) * limit;\n      const end = start + limit;\n\n      const result = {\n        books: allBooks.slice(start, end),\n        total: allBooks.length,\n        showing: Math.min(end, allBooks.length),\n        hasMore: end < allBooks.length,\n        currentPage: page,\n      };\n\n      this.cache.set(k, result);\n      return result;\n    } catch (e) {\n      throw new Error(`Failed to load books: ${e.message}`);\n    }\n  }\n}\n\nconst api = new BooksAPI();\n\nexport const getBookById = async id => {\n  try {\n    const { data } = await axios.get(`${BOOKS_BASE_URL}/books/${id}`);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};","export default {\n  elBookModal: document.querySelector('#book-modal'),\n  elModalContent: modal.querySelector('.modal-content'),\n  elBtnOpenModal: document.getElementById('open-modal-btn'),\n  footerForm: document.querySelector('.footer-input-box'),\n  footerInput: document.querySelector('.footer-input'),\n  footerRemark: document.querySelector('.footer-remark'),\n  footerBtn: document.querySelector('.footer-btn'),\n};\n\n","// src/js/render-functions.js\nimport { HTML_ESCAPE_MAP } from './constants.js';\nimport refs from './refs';\n\nexport function escapeHtml(text) {\n  if (!text) return '';\n  return String(text).replace(/[&<>\"']/g, m => HTML_ESCAPE_MAP[m]);\n}\n\n/** Single book card */\nexport function createBookCard(book, index = 0) {\n  const li = document.createElement('li');\n  li.className = 'book-card';\n  li.style.animationDelay = `${(index % 8) * 0.05 + 0.1}s`;\n\n  const priceText = book.price && book.price !== '$0' ? book.price : '';\n\n  li.innerHTML = `\n    <div class=\"book-media\">\n      <img\n        class=\"book-cover loading\"\n        src=\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='227' height='323'%3E%3Crect width='100%25' height='100%25' fill='%23f0f0f0'/%3E%3C/svg%3E\"\n        ${book.image ? `data-src=\"${book.image}\"` : ''}\n        alt=\"${escapeHtml(book.title)}\"\n        loading=\"lazy\"\n      >\n    </div>\n    <div class=\"book-info\">\n      <div class=\"book-title-row\">\n        <h3 class=\"book-title\">${escapeHtml(book.title)}</h3>\n        ${\n          priceText\n            ? `<span class=\"book-price\">${escapeHtml(priceText)}</span>`\n            : ''\n        }\n      </div>\n      <p class=\"book-author\">${escapeHtml(book.author)}</p>\n    </div>\n    <div class=\"book-footer\">\n      <button\n        class=\"learn-more-btn\"\n        type=\"button\"\n        data-book-id=\"${escapeHtml(book.id)}\"\n        data-amazon-url=\"${escapeHtml(book.amazon_product_url)}\"\n      >\n        Learn More\n      </button>\n    </div>\n  `;\n  return li;\n}\n\nexport function createCategoryItem(name, value, isActive) {\n  return `\n    <li class=\"category-item ${\n      isActive ? 'active' : ''\n    }\" data-category=\"${escapeHtml(value)}\">\n      <button class=\"category-button\" type=\"button\" data-category=\"${escapeHtml(\n        value\n      )}\">\n        ${escapeHtml(name)}\n      </button>\n    </li>\n  `;\n}\n\nexport function renderCategories(\n  container,\n  categories,\n  activeCategory = 'all'\n) {\n  if (!container) return;\n  container.innerHTML = categories\n    .map(c => createCategoryItem(c.name, c.value, c.value === activeCategory))\n    .join('');\n}\n\nexport function populateDropdowns(\n  dropdowns,\n  categories,\n  activeCategory = 'all'\n) {\n  dropdowns.forEach(select => {\n    if (!select) return;\n    select.innerHTML = categories\n      .map(\n        c => `<option value=\"${escapeHtml(c.value)}\" ${\n          c.value === activeCategory ? 'selected' : ''\n        }>\n          ${escapeHtml(c.name)}\n        </option>`\n      )\n      .join('');\n  });\n}\n\n/** Books list renderers */\nexport function renderBooks(container, books) {\n  if (!container) return;\n  container.innerHTML = '';\n  if (!books || books.length === 0) {\n    container.innerHTML = `<li class=\"no-books\">No books found</li>`;\n    return;\n  }\n  books.forEach((b, i) => {\n    const card = createBookCard(b, i);\n    container.appendChild(card);\n  });\n}\n\nexport function appendBooks(container, books) {\n  if (!container || !books?.length) return;\n  const start = container.children.length;\n  books.forEach((b, i) => {\n    const card = createBookCard(b, start + i);\n    container.appendChild(card);\n  });\n}\n\n/** UI helpers */\nexport function updateBooksCounter(counter, showing, total) {\n  if (counter) counter.textContent = `Showing ${showing} of ${total}`;\n}\n\nexport function updateShowMoreButton(button, hasMore, isLoading) {\n  if (!button) return;\n  const text = button.querySelector('.button-text');\n  if (!text) return;\n\n  if (isLoading) {\n    text.textContent = 'Loading...';\n    button.disabled = true;\n  } else if (hasMore) {\n    text.textContent = 'Show More';\n    button.disabled = false;\n    button.style.display = 'block';\n  } else {\n    button.style.display = 'none';\n  }\n}\n\nexport function showError(errorElement, message) {\n  if (!errorElement) return;\n  const messageElement = errorElement.querySelector('.error-message');\n  if (messageElement) messageElement.textContent = message;\n  errorElement.style.display = 'block';\n}\n\nexport function hideError(errorElement) {\n  if (errorElement) errorElement.style.display = 'none';\n}\n\nexport function setLoading(loader, listEl, isLoading) {\n  loader?.classList.toggle('hidden', !isLoading);\n  listEl?.setAttribute('aria-busy', String(isLoading));\n}\n\nexport function setCategoriesLoading(loader, isLoading) {\n  loader?.classList.toggle('hidden', !isLoading);\n}\n\nexport function updateCategoriesActiveState(container, activeCategory) {\n  if (!container) return;\n  container.querySelectorAll('.category-item').forEach(li => {\n    li.classList.toggle('active', li.dataset.category === activeCategory);\n  });\n}\n\nexport function createBookModalCard(book) {\n  const bookCard = document.createElement('div');\n  bookCard.className = 'modal-book-layout';\n\n  const priceDisplay =\n    book.price && book.price !== '0.00' ? book.price : '0.00';\n\n  const description =\n    book.description && book.description.trim() !== ''\n      ? book.description\n      : null;\n\n  const publisherText = book.publisher\n    ? `<br>Publisher: <b>${book.publisher}</b>.`\n    : null;\n\n  const weeksCount = book.weeks_on_list;\n  const weeksText = weeksCount === 1 ? 'week' : 'weeks';\n\n  const rankText =\n    book.rank && book.rank > 0 && weeksCount && weeksCount > 0\n      ? `<br>This book is ranked <b>#${book.rank}</b> on the bestseller list, having been on it for <b>${weeksCount}</b> ${weeksText}.`\n      : null;\n\n  let detailsContent = description || '';\n\n  if (description) {\n    let additionalInfo = '';\n    if (publisherText) additionalInfo += publisherText;\n    if (rankText) additionalInfo += rankText;\n\n    if (additionalInfo) {\n      detailsContent += additionalInfo;\n    }\n  }\n\n  if (!detailsContent) {\n    detailsContent = 'No description available for this book.';\n  }\n\n  bookCard.innerHTML = `\n        <img\n            class=\"book-cover-img\"\n            src=\"${book.book_image || ''}\"\n            alt=\"Book cover for '${book.title}' by ${book.author}\"\n            width=\"309\"\n            height=\"467\"\n        />\n\n        <div class=\"mobile-content\">\n            <div class=\"section-header\">\n                <h2 class=\"book-title-mobile\">${book.title}</h2>\n                <p class=\"book-author\">${book.author}</p>\n                <p class=\"price-mobile\">$${priceDisplay}</p>\n            </div>\n\n            <div class=\"quantity-control\" data-item-id=\"${book._id}\">\n                <button type=\"button\" class=\"decrease-btn\" aria-label=\"Decrease quantity\" disabled>-</button>\n                <input type=\"number\" class=\"quantity-input\" value=\"1\" min=\"1\" max=\"99\" aria-label=\"Book quantity\"/>\n                <button type=\"button\" class=\"increase-btn\" aria-label=\"Increase quantity\">+</button>\n            </div>\n\n            <div class=\"modal-book-actions\">\n                <button class=\"btn add-to-cart-btn\" type=\"button\" data-action=\"add-to-cart\">Add to Cart</button>\n                <button class=\"btn buy-now-btn btn-secondary\" type=\"button\" data-action=\"buy-now\">Buy Now</button>\n            </div>\n            \n            <div class=\"accordion-container\">\n                <div class=\"ac\">\n                    <div class=\"ac-header\">\n                        <h4 class=\"ac-title\">Details</h4>\n                        <svg class=\"ac-icon arrow-down\" width=\"24\" height=\"25\">\n                            <use href=\"./img/symbol-defs.svg#icon-chevron-down\"></use>\n                        </svg>\n                        <svg class=\"ac-icon arrow-up\" width=\"24\" height=\"25\">\n                            <use href=\"./img/symbol-defs.svg#icon-chevron-up\"></use>\n                        </svg>\n                    </div>\n                    <div class=\"ac-panel\">\n                        <p class=\"ac-text\">${detailsContent}</p>\n                    </div>\n                </div>\n\n                <div class=\"ac\">\n                    <div class=\"ac-header\">\n                        <h4 class=\"ac-title\">Shipping</h4> \n                        <svg class=\"ac-icon arrow-down\" width=\"24\" height=\"25\">\n                            <use href=\"./img/symbol-defs.svg#icon-chevron-down\"></use>\n                        </svg>\n                        <svg class=\"ac-icon arrow-up\" width=\"24\" height=\"25\">\n                            <use href=\"./img/symbol-defs.svg#icon-chevron-up\"></use>\n                        </svg>\n                    </div>\n                    <div class=\"ac-panel\">\n                        <p class=\"ac-text\">\n                            We ship across the United States within 2-6 business days. All\n                            orders are processed through USPS or a reliable courier service. Enjoy free standard shipping on orders over $50.\n                        </p>\n                    </div>\n                </div>\n            \n                <div class=\"ac\">\n                    <div class=\"ac-header\">\n                        <h4 class=\"ac-title\">Returns</h4> \n                        <svg class=\"ac-icon arrow-down\" width=\"24\" height=\"25\">\n                            <use href=\"./img/symbol-defs.svg#icon-chevron-down\"></use>\n                        </svg>\n                        <svg class=\"ac-icon arrow-up\" width=\"24\" height=\"25\">\n                            <use href=\"./img/symbol-defs.svg#icon-chevron-up\"></use>\n                        </svg>\n                    </div>\n                    <div class=\"ac-panel\">\n                        <p class=\"ac-text\">\n                            You can return an item within 14 days of receiving your order,\n                            provided it hasn't been used and is in its original condition.\n                            To start a return, please contact our support team — we'll guide you through the process quickly and hassle-free.\n                        </p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    `;\n  return bookCard;\n}\n","import Accordion from 'accordion-js';\nimport 'accordion-js/dist/accordion.min.css';\n\nimport refs from './refs.js';\nimport { createBookModalCard } from './render-functions.js';\n\nexport async function openBookModal(book) {\n    const modal = refs.elBookModal;\n    \n    refs.elModalContent.querySelectorAll('.modal-book-layout').forEach(el => el.remove()); \n    const bookCard = createBookModalCard(book);\n    refs.elModalContent.appendChild(bookCard);\n\n    modal.classList.add('active', 'is-open');\n    modal.setAttribute('aria-hidden', 'false');\n    \n    document.body.classList.add('modal-open');\n    document.documentElement.classList.add('modal-open'); \n\n    refs.elBookModal.addEventListener('click', handleBookModal);\n    window.addEventListener('keydown', handleEsc, { once: true });\n\n    const accordions = Array.from(refs.elModalContent.querySelectorAll(\".accordion-container\"));\n    if (accordions.length > 0) {\n        new Accordion(accordions, {\n            duration: 300,\n            showMultiple: true,\n            triggerClass: 'ac-header',\n        });\n    }\n}\n\n\nexport function closeBookModal() {\n    const modal = refs.elBookModal;\n\n    document.body.focus(); \n    \n    refs.elBookModal.removeEventListener('click', handleBookModal);\n    \n    modal.classList.remove('active', 'is-open');\n    modal.setAttribute('aria-hidden', 'true');\n    \n    refs.elModalContent.querySelectorAll('.modal-book-layout').forEach(el => el.remove());\n\n    const otherModalsOpen =\n        document.querySelectorAll('.modal-backdrop.is-open').length > 0;\n        \n    if (!otherModalsOpen) {\n        document.body.classList.remove('modal-open');\n        document.documentElement.classList.remove('modal-open');\n    }\n}\n\nexport function handleBookModal(e) {\n    if (e.target.closest('.modal-close-btn')) {\n        return closeBookModal();\n    }\n    if (e.target === refs.elBookModal) {\n        return closeBookModal();\n    }\n\n    const targetBtn = e.target.closest('.decrease-btn') || e.target.closest('.increase-btn');\n    if (targetBtn) {\n        const quantityControl = targetBtn.closest('.quantity-control');\n        const input = quantityControl.querySelector('.quantity-input');\n        \n        let value = parseInt(input.value);\n        const min = parseInt(input.min) || 1;\n        const max = parseInt(input.max) || 99;\n\n        if (targetBtn.classList.contains('increase-btn') && value < max) {\n            input.value = value + 1;\n        } else if (targetBtn.classList.contains('decrease-btn') && value > min) {\n            input.value = value - 1;\n        }\n\n        quantityControl.querySelector('.decrease-btn').disabled = parseInt(input.value) <= min;\n        \n        return;\n    }\n\n     \n\n\n}\n\nexport function handleEsc(e) {\n    if (e.key === 'Escape') {\n        return closeBookModal();\n    }\n}","import refs from './refs';\nimport { getBookById } from './api-service';\nimport { openBookModal } from './modal-book';\n\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { validateEmail } from './helpers.js';\nimport { TOAST_DELAY, MESSAGES } from './constants.js';\nimport { saveEmailToLocal } from './storage.js';\n\n\nexport function createShowMoreHandler(section) {\n  return () => section.loadMore();\n}\n\nexport function createBookClickHandler() {\n  return async function handler(e) {\n    const btn = e.target.closest('.learn-more-btn');\n    if (!btn) return;\n    e.preventDefault();\n\n    const bookId = btn.dataset.bookId;\n    if (!bookId || bookId === 'no-id') return;\n\n    try {\n      const bookData = await getBookById(bookId);\n      openBookModal(bookData);\n    } catch (error) {\n      console.error('Error fetching book:', error);\n    }\n  };\n}\n\nexport function createResizeHandler(section) {\n  return () => {\n    if (section.debounceTimeout) clearTimeout(section.debounceTimeout);\n    section.debounceTimeout = setTimeout(() => {\n      const cards =\n        section.elements.booksGrid?.querySelectorAll('.book-card') ?? [];\n      cards.forEach(\n        (card, i) => (card.style.animationDelay = `${(i % 8) * 0.05 + 0.1}s`)\n      );\n    }, 250);\n  };\n}\n\nexport function createCategoryChangeHandler(section) {\n  return e => section.filterByCategory(e.target.value);\n}\n\nexport function createCategoryButtonHandler(section) {\n  return e => {\n    const li = e.currentTarget.closest('.category-item');\n    const cat = li?.dataset.category;\n    if (cat && cat !== section.currentCategory) section.filterByCategory(cat);\n  };\n}\n\nexport function createRetryHandler(section) {\n  return () => section.loadBooks(true);\n}\n\nexport function createIntersectionObserver(onLoad) {\n  return new IntersectionObserver(\n    entries => {\n      entries.forEach(entry => {\n        if (entry.isIntersecting) onLoad(entry.target);\n      });\n    },\n    { rootMargin: '50px 0px' }\n  );\n}\n\nexport function loadImage(img, observer) {\n  const src = img.dataset.src;\n  if (!src) return;\n  img.classList.add('loading');\n  const t = new Image();\n  t.onload = () => {\n    img.src = src;\n    img.classList.remove('loading');\n    img.classList.add('loaded');\n    delete img.dataset.src;\n    observer?.unobserve(img);\n  };\n  t.onerror = () => {\n    img.classList.remove('loading');\n    img.classList.add('error');\n    observer?.unobserve(img);\n  };\n  t.src = src;\n}\n\n// -----footer-----\nfunction showToast(type, title, message) {\n  iziToast[type]({\n    title,\n    message,\n    position: 'topRight',\n  });\n}\n\nexport function onFooterSubmit(e) {\n  e.preventDefault();\n\n  const email = refs.footerInput.value.trim();\n\n  refs.footerBtn.classList.remove('btn-error', 'btn-success');\n  refs.footerRemark.classList.remove('remark-error', 'remark-success');\n\n  if (!email) {\n    refs.footerRemark.textContent = MESSAGES.REQUIRED;\n    refs.footerRemark.classList.add('remark-error');\n    showToast('warning', 'Caution', MESSAGES.REQUIRED);\n    setTimeout(clearFormState, TOAST_DELAY);\n    return;\n  }\n\n  if (!validateEmail(email)) {\n    refs.footerRemark.textContent = MESSAGES.INVALID;\n    refs.footerRemark.classList.add('remark-error');\n    refs.footerBtn.classList.add('btn-error');\n    showToast('error', 'Error', MESSAGES.INVALID);\n    setTimeout(clearFormState, TOAST_DELAY);\n    return;\n  }\n\n  refs.footerRemark.textContent = '✅ ' + MESSAGES.SUCCESS;\n  refs.footerRemark.classList.add('remark-success');\n  refs.footerBtn.classList.add('btn-success');\n  showToast('success', 'OK', MESSAGES.SUCCESS);\n\n  saveEmailToLocal(email);\n\n  setTimeout(clearFormState, TOAST_DELAY);\n  refs.footerForm.reset();\n}\n\nfunction clearFormState() {\n  refs.footerRemark.textContent = '';\n  refs.footerRemark.classList.remove('remark-error', 'remark-success');\n  refs.footerBtn.classList.remove('btn-error', 'btn-success');\n}\n// -----footer-end-----","// src/js/books-data.js\nimport { api } from './api-service.js';\nimport { DOM_ELEMENTS, BOOKS_CONFIG } from './constants.js';\nimport {\n  renderCategories,\n  populateDropdowns,\n  renderBooks,\n  appendBooks,\n  updateBooksCounter,\n  updateShowMoreButton,\n  showError,\n  hideError,\n  setLoading,\n  setCategoriesLoading,\n  updateCategoriesActiveState,\n} from './render-functions.js';\nimport {\n  createShowMoreHandler,\n  createBookClickHandler,\n  createResizeHandler,\n  createCategoryChangeHandler,\n  createCategoryButtonHandler,\n  createRetryHandler,\n  createIntersectionObserver,\n  loadImage,\n} from './handlers.js';\n\n/* ----------------------------- UI-level dedupe ----------------------------- */\nfunction norm(s) {\n  return String(s || '')\n    .toLowerCase()\n    .replace(/&amp;/g, '&')\n    .replace(/\\s+/g, ' ')\n    .replace(/[^\\p{L}\\p{N}\\s]/gu, '')\n    .trim();\n}\n\nfunction keyTA(b) {\n  const t = norm(b.title);\n  const a = norm(b.author);\n  return t || a ? `ta:${t}|${a}` : `id:${b.id || 'no-id'}`;\n}\n\nfunction dedupeForUI(list = []) {\n  const seen = new Set();\n  const out = [];\n  for (const b of list) {\n    const k = keyTA(b);\n    if (seen.has(k)) continue;\n    seen.add(k);\n    out.push(b);\n  }\n  return out;\n}\n\n/**\n * Merge `existing` with `candidates` and take at most `takeCount` NEW unique items\n * (unique by title+author). Returns { merged, newItems }.\n */\nfunction mergeTakeNew(existing, candidates, takeCount) {\n  const seen = new Set(existing.map(keyTA));\n  const merged = existing.slice();\n  const newItems = [];\n  for (const b of candidates) {\n    const k = keyTA(b);\n    if (seen.has(k)) continue;\n    seen.add(k);\n    merged.push(b);\n    newItems.push(b);\n    if (newItems.length >= takeCount) break;\n  }\n  return { merged, newItems };\n}\n\n/* --------------------------------- Class ---------------------------------- */\nclass BooksSection {\n  constructor() {\n    this.elements = {\n      booksGrid: document.getElementById(DOM_ELEMENTS.booksGrid),\n      booksLoader: document.getElementById(DOM_ELEMENTS.booksLoader),\n      showMoreBtn: document.getElementById(DOM_ELEMENTS.showMoreBtn),\n      categoriesUL: document.getElementById(DOM_ELEMENTS.categoriesList),\n      categoriesLoader: document.getElementById(DOM_ELEMENTS.categoriesLoader),\n      errorElement: document.getElementById(DOM_ELEMENTS.booksError),\n      booksCounter: document.getElementById(DOM_ELEMENTS.booksCounter),\n      categoriesSelectTablet: document.getElementById(\n        DOM_ELEMENTS.categoriesSelectTablet\n      ),\n      categoriesSelectMobile: document.getElementById(\n        DOM_ELEMENTS.categoriesSelectMobile\n      ),\n    };\n\n    this.currentCategory = 'all';\n    this.currentPage = 1;\n    this.isLoading = false;\n    this.hasMore = true;\n    this.loadedBooks = [];\n\n    this.imageObserver = null;\n    this.debounceTimeout = null;\n\n    this.initialCount = this.getInitialBooksCount();\n    this.init();\n  }\n\n  async init() {\n    try {\n      hideError(this.elements.errorElement);\n      this.setupEventListeners();\n      this.setupObservers();\n      await this.renderCategories();\n      await this.loadBooks(true);\n    } catch (e) {\n      console.error('Books init error:', e);\n      showError(\n        this.elements.errorElement,\n        'Failed to load books. Please try again.'\n      );\n    }\n  }\n\n  setupEventListeners() {\n    this.elements.showMoreBtn?.addEventListener(\n      'click',\n      createShowMoreHandler(this)\n    );\n    this.elements.booksGrid?.addEventListener(\n      'click',\n      createBookClickHandler()\n    );\n    window.addEventListener('resize', createResizeHandler(this));\n    this.elements.categoriesSelectTablet?.addEventListener(\n      'change',\n      createCategoryChangeHandler(this)\n    );\n    this.elements.categoriesSelectMobile?.addEventListener(\n      'change',\n      createCategoryChangeHandler(this)\n    );\n    this.elements.errorElement\n      ?.querySelector('.retry-btn')\n      ?.addEventListener('click', createRetryHandler(this));\n  }\n\n  setupObservers() {\n    if ('IntersectionObserver' in window) {\n      this.imageObserver = createIntersectionObserver(img =>\n        loadImage(img, this.imageObserver)\n      );\n    }\n  }\n\n  async renderCategories() {\n    if (!this.elements.categoriesUL) return;\n    setCategoriesLoading(this.elements.categoriesLoader, true);\n    try {\n      const categories = await api.getCategories();\n      renderCategories(\n        this.elements.categoriesUL,\n        categories,\n        this.currentCategory\n      );\n      this.elements.categoriesUL\n        .querySelectorAll('.category-button')\n        .forEach(btn =>\n          btn.addEventListener('click', createCategoryButtonHandler(this))\n        );\n      populateDropdowns(\n        [\n          this.elements.categoriesSelectTablet,\n          this.elements.categoriesSelectMobile,\n        ],\n        categories,\n        this.currentCategory\n      );\n    } finally {\n      setCategoriesLoading(this.elements.categoriesLoader, false);\n    }\n  }\n\n  async loadBooks(reset = false) {\n    if (this.isLoading) return;\n    this.setLoading(true);\n    hideError(this.elements.errorElement);\n    try {\n      const limit = reset\n        ? this.getInitialBooksCount()\n        : window.innerWidth <= BOOKS_CONFIG.mobileBreakpoint\n        ? BOOKS_CONFIG.perLoadMoreMobile\n        : BOOKS_CONFIG.perLoadMoreDesktop;\n      const page = reset ? 1 : this.currentPage + 1;\n      const data = await api.getBooks(this.currentCategory, page, limit);\n\n      if (reset) {\n        this.loadedBooks = [...data.books];\n        this.currentPage = 1;\n        renderBooks(this.elements.booksGrid, this.loadedBooks);\n      } else {\n        this.loadedBooks.push(...data.books);\n        this.currentPage = page;\n        appendBooks(this.elements.booksGrid, data.books);\n      }\n\n      this.setupLazyLoading();\n\n      const total =\n        typeof data.total === 'number'\n          ? data.total\n          : dedupeForUI(this.loadedBooks).length;\n\n      // hasMore if server still has items AND we still didn't hit total\n      this.hasMore = Boolean(data.hasMore) && this.loadedBooks.length < total;\n\n      this.updateShowMoreButton();\n      updateBooksCounter(\n        this.elements.booksCounter,\n        this.loadedBooks.length,\n        total\n      );\n    } catch (e) {\n      console.error('Load books error:', e);\n      showError(\n        this.elements.errorElement,\n        `Failed to load books: ${e.message}`\n      );\n    } finally {\n      this.setLoading(false);\n    }\n  }\n\n  setupLazyLoading() {\n    if (!this.imageObserver) return;\n    this.elements.booksGrid\n      ?.querySelectorAll('.book-cover[data-src]')\n      .forEach(img => this.imageObserver.observe(img));\n  }\n\n  async filterByCategory(category) {\n    if (category === this.currentCategory) return;\n\n    this.currentCategory = category;\n    this.currentPage = 1;\n    this.loadedBooks = [];\n\n    updateCategoriesActiveState(this.elements.categoriesUL, category);\n    if (this.elements.categoriesSelectTablet)\n      this.elements.categoriesSelectTablet.value = category;\n    if (this.elements.categoriesSelectMobile)\n      this.elements.categoriesSelectMobile.value = category;\n    await this.loadBooks(true);\n  }\n\n  async loadMore() {\n    if (!this.hasMore || this.isLoading) return;\n    await this.loadBooks(false);\n  }\n  updateShowMoreButton() {\n    updateShowMoreButton(\n      this.elements.showMoreBtn,\n      this.hasMore,\n      this.isLoading\n    );\n  }\n  getInitialBooksCount() {\n    return window.innerWidth <= BOOKS_CONFIG.mobileBreakpoint\n      ? BOOKS_CONFIG.initialPerPageMobile\n      : BOOKS_CONFIG.initialPerPageDesktop;\n  }\n  setLoading(v) {\n    this.isLoading = v;\n    setLoading(this.elements.booksLoader, this.elements.booksGrid, v);\n    this.updateShowMoreButton();\n  }\n  destroy() {\n    this.imageObserver?.disconnect();\n    if (this.debounceTimeout) clearTimeout(this.debounceTimeout);\n  }\n}\n\nexport default BooksSection;\n","import BooksSection from './books-data.js';\n\n// Keep a single instance across HMR & repeated imports\nlet instance = window.__booksSectionInstance || null;\n\nexport function mountBooks() {\n  if (instance) return instance;\n  instance = new BooksSection();\n  window.__booksSectionInstance = instance;\n  return instance;\n}\n\n// Auto–mount exactly once\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', () => mountBooks(), { once: true });\n} else {\n  mountBooks();\n}\n\n// Clean up on Vite HMR to avoid duplicated mounts\nif (import.meta?.hot) {\n  import.meta.hot.dispose(() => {\n    if (instance) {\n      instance.destroy?.();\n      instance = null;\n      window.__booksSectionInstance = null;\n    }\n  });\n}\n\n\n"],"names":["navbar","Swiper","Navigation","Pagination","A11y","Keyboard","Mousewheel","swiperElement","swiper","next","prev","BOOKS_BASE_URL","REQUEST_TIMEOUT","RETRY_ATTEMPTS","RETRY_DELAY","BOOKS_CONFIG","CACHE_CONFIG","FALLBACK_CATEGORIES","DOM_ELEMENTS","HTML_ESCAPE_MAP","fetchJSON","path","options","controller","timeoutId","lastError","attempt","res","txt","err","r","normalizeBook","book","fallbackImage","MemoryCache","maxSize","ttl","key","value","first","item","BooksAPI","cached","data","categories","c","n","result","category","page","limit","k","endpoint","allBooks","seen","list","b","_a","start","end","e","api","getBookById","id","axios","error","refs","escapeHtml","text","m","createBookCard","index","li","priceText","createCategoryItem","name","isActive","renderCategories","container","activeCategory","populateDropdowns","dropdowns","select","renderBooks","books","i","card","appendBooks","updateBooksCounter","counter","showing","total","updateShowMoreButton","button","hasMore","isLoading","showError","errorElement","message","messageElement","hideError","setLoading","loader","listEl","setCategoriesLoading","updateCategoriesActiveState","createBookModalCard","bookCard","priceDisplay","description","publisherText","weeksCount","weeksText","rankText","detailsContent","additionalInfo","openBookModal","modal","el","handleBookModal","handleEsc","accordions","Accordion","closeBookModal","targetBtn","quantityControl","input","min","max","createShowMoreHandler","section","createBookClickHandler","btn","bookId","bookData","createResizeHandler","createCategoryChangeHandler","createCategoryButtonHandler","cat","createRetryHandler","createIntersectionObserver","onLoad","entries","entry","loadImage","img","observer","src","t","norm","s","keyTA","a","dedupeForUI","out","BooksSection","_b","_c","_d","_f","_e","reset","v","instance","mountBooks"],"mappings":"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"}