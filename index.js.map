{"version":3,"file":"index.js","sources":["../src/js/burger-menu.js","../src/js/slider-feedbacks.js","../src/js/slider-hero.js","../src/js/constants.js","../src/js/api-service.js","../src/js/refs.js","../src/js/render-functions.js","../src/js/storage.js","../src/js/cart.js","../src/js/modal-book.js","../src/js/helpers.js","../src/js/handlers.js","../src/js/books-data.js","../src/js/books.js","../src/js/modal-contact.js","../src/js/slider-events.js","../src/js/join-form.js"],"sourcesContent":["const refs = {\r\n  navbar: document.querySelector('[data-navbar]'),\r\n  burgerOpen: document.querySelector('[data-navbar-open]'),\r\n  burgerClose: document.querySelector('[data-navbar-close]'),\r\n  navbarLink: document.querySelector('.navbar-nav-list'),\r\n};\r\n\r\nrefs.burgerOpen.addEventListener('click', () => {\r\n  refs.navbar.classList.remove('is-close');\r\n  refs.navbar.classList.add('is-open');\r\n  refs.burgerOpen.setAttribute('aria-expanded', 'true');\r\n  document.body.classList.add('no-scroll');\r\n});\r\n\r\nfunction closeNavbar() {\r\n  refs.navbar.classList.replace('is-open', 'is-close');\r\n  document.body.classList.remove('no-scroll');\r\n  refs.burgerOpen.setAttribute('aria-expanded', 'false');\r\n}\r\n\r\nrefs.burgerClose.addEventListener('click', () => {\r\n  closeNavbar();\r\n});\r\n\r\nrefs.navbarLink.addEventListener('click', e => {\r\n  if (e.target.className === 'navbar-nav-list') {\r\n    return;\r\n  }\r\n  closeNavbar();\r\n});\r\n","import Swiper from 'swiper';\nimport 'swiper/css';\nimport 'swiper/css/navigation';\nimport 'swiper/css/pagination';\nimport {\n  Navigation,\n  Pagination,\n  A11y,\n  Keyboard,\n  Mousewheel,\n} from 'swiper/modules';\n\nSwiper.use([Navigation, Pagination, A11y, Keyboard, Mousewheel]);\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  const swiperElement = document.querySelector('.feedbacks-slider');\n\n  if (!swiperElement) {\n    console.error('Swiper: Контейнер .feedbacks-slider не знайдено.');\n    return;\n  }\n\n  const swiper = new Swiper(swiperElement, {\n    slidesPerView: 1,\n    spaceBetween: 24,\n    watchOverflow: true,\n\n    navigation: {\n      nextEl: '.feedbacks-arrows .swiper-button-next',\n      prevEl: '.feedbacks-arrows .swiper-button-prev',\n    },\n    pagination: {\n      el: '.carousel-navigation .feedbacks-pagination',\n      clickable: true,\n    },\n    a11y: {\n      enabled: true,\n    },\n    keyboard: {\n      enabled: true,\n    },\n    mousewheel: {\n      enabled: true,\n      forceToAxis: true,\n    },\n\n    breakpoints: {\n      320: {\n        slidesPerView: 1,\n        spaceBetween: 24,\n      },\n      768: {\n        slidesPerView: 2,\n        spaceBetween: 32,\n      },\n      1440: {\n        slidesPerView: 3,\n        spaceBetween: 32,\n      },\n    },\n  });\n});\n","import Swiper from 'swiper/bundle';\nimport 'swiper/css/bundle';\n\nconst swiper = new Swiper('.heroSwiper', {\n  spaceBetween: 2,\n  slidesPerView: 1,\n  speed: 1000,\n  keyboard: {\n    enabled: true,\n  },\n  autoplay: {\n    delay: 5000,\n    disableOnInteraction: false,\n  },\n  on: {\n    init: () => {\n      document.querySelector('.heroSwiper').style.visibility = 'visible';\n    },\n  },\n});\n\nconst nextBtn = document.querySelector('.button-next');\nconst prevBtn = document.querySelector('.button-prev');\n\nfunction updateButtons() {\n  if (swiper.isBeginning) {\n    prevBtn.disabled = true;\n    prevBtn.classList.add('disabled');\n  } else {\n    prevBtn.disabled = false;\n    prevBtn.classList.remove('disabled');\n  }\n\n  if (swiper.isEnd) {\n    nextBtn.disabled = true;\n    nextBtn.classList.add('disabled');\n  } else {\n    nextBtn.disabled = false;\n    nextBtn.classList.remove('disabled');\n  }\n}\n\nupdateButtons();\n\nswiper.on('slideChange', updateButtons);\n\nnextBtn.addEventListener('click', () => {\n  swiper.slideNext();\n});\n\nprevBtn.addEventListener('click', () => {\n  swiper.slidePrev();\n});\n","\nexport const BOOKS_BASE_URL = 'https://books-backend.p.goit.global';\nexport const REQUEST_TIMEOUT = 10000;\nexport const RETRY_ATTEMPTS = 3;\nexport const RETRY_DELAY = 1000;\n\n// UI/логіка\nexport const BOOKS_CONFIG = {\n  initialPerPageMobile: 10,\n  initialPerPageDesktop: 24,\n  perLoadMoreDesktop: 24,\n  perLoadMoreMobile: 10,\n  mobileBreakpoint: 768,\n  tabletBreakpoint: 1024,\n};\n\n// Cache\nexport const CACHE_CONFIG = {\n  maxSize: 50,\n  ttl: 5 * 60 * 1000,\n};\n\n// Фолбек-категорії\nexport const FALLBACK_CATEGORIES = [\n  'Hardcover Fiction','Hardcover Nonfiction','Trade Fiction Paperback','Mass Market Monthly',\n  'Paperback Trade Fiction','Paperback Nonfiction','E-Book Fiction','E-Book Nonfiction',\n  'Hardcover Advice','Paperback Advice','Advice How-To and Miscellaneous',\n  \"Children's Middle Grade Hardcover\",'Picture Books','Series Books','Young Adult Hardcover',\n  'Audio Fiction','Audio Nonfiction','Business Books','Graphic Books and Manga',\n  'Mass Market','Middle Grade Paperback','Young Adult Paperback',\n];\n\n// ID елементів у DOM\nexport const DOM_ELEMENTS = {\n  booksGrid: 'books-grid',\n  booksLoader: 'books-loader',\n  showMoreBtn: 'show-more-btn',\n  categoriesList: 'categories-list',\n  categoriesLoader: 'categories-loader',\n  booksError: 'books-error',\n  booksCounter: 'books-counter-text',\n  categoriesSelectTablet: 'categories-select-tablet',\n  categoriesSelectMobile: 'categories-select-mobile',\n};\n\n// для екранування\nexport const HTML_ESCAPE_MAP = { '&':'&amp;','<':'&lt;','>':'&gt;','\"':'&quot;',\"'\":'&#039;' };\n\n// -----footer-----\nexport const STORAGE_KEYS = {\n  EMAILS: 'emails',\n};\n\nexport const TOAST_DELAY = 3000;\n\nexport const MESSAGES = {\n  REQUIRED: '* Required field',\n  INVALID: 'Please enter a valid email',\n  SUCCESS: 'Email saved!',\n};\n// -----footer-end-----\n\n// ----modal-book------\nexport const CARTKEY = 'cart';\nexport const BUYKEY = 'buy';\nexport const ORDERKEY = 'order';\n","import {\n  BOOKS_BASE_URL,\n  REQUEST_TIMEOUT,\n  RETRY_ATTEMPTS,\n  RETRY_DELAY,\n  FALLBACK_CATEGORIES,\n  CACHE_CONFIG,\n} from './constants.js';\n\nimport axios from 'axios';\n\n/* -------------------------- exports -------------------------- */\nexport { fetchJSON, normalizeBook, api };\n\n/* -------------------------- fetch helpers -------------------------- */\nasync function fetchJSON(path, options = {}) {\n  const controller = new AbortController();\n  const timeoutId = setTimeout(() => controller.abort(), REQUEST_TIMEOUT);\n  let lastError = null;\n\n  for (let attempt = 1; attempt <= RETRY_ATTEMPTS; attempt++) {\n    try {\n      const res = await fetch(`${BOOKS_BASE_URL}${path}`, {\n        signal: controller.signal,\n        headers: {\n          'Content-Type': 'application/json',\n          Accept: 'application/json',\n        },\n        ...options,\n      });\n      clearTimeout(timeoutId);\n\n      if (!res.ok) {\n        const txt = await res.text().catch(() => '');\n        throw new Error(`API ${res.status}: ${res.statusText}. ${txt}`);\n      }\n      return await res.json();\n    } catch (err) {\n      lastError = err;\n      if (err.name === 'AbortError')\n        throw new Error('Request timeout. Please check your connection.');\n      if (attempt === RETRY_ATTEMPTS) throw lastError;\n      await new Promise(r => setTimeout(r, RETRY_DELAY * attempt));\n    }\n  }\n}\n\n/* -------------------------- normalization -------------------------- */\nfunction normalizeBook(book, fallbackImage = '') {\n  return {\n    id: book._id || 'no-id',\n    title: book.title || 'Untitled',\n    author: book.author || 'Unknown Author',\n    image: book.book_image || fallbackImage,\n    amazon_product_url: book.amazon_product_url || '#',\n    price: book.price || '',\n  };\n}\n\n/* -------------------------- canonization -------------------------- */\nfunction canon(s) {\n  return String(s || '')\n    .toLowerCase()\n    .normalize('NFKD')\n    .replace(/[\\u0300-\\u036f]/g, '')\n    .replace(/&amp;/g, '&')\n    .replace(/\\s+/g, ' ')\n    .replace(/[^\\p{L}\\p{N}\\s]/gu, '')\n    .trim();\n}\n\n/* -------------------------- deduplication -------------------------- */\nfunction dedupeStable(list) {\n  const out = [];\n  const byId = new Set();\n  const byTA = new Set();\n\n  for (const b of list) {\n    if (b?.id && b.id !== 'no-id') {\n      const k = `id:${b.id}`;\n      if (byId.has(k)) continue;\n      byId.add(k);\n      const ta = `ta:${canon(b.title)}|${canon(b.author)}`;\n      byTA.add(ta);\n      out.push(b);\n      continue;\n    }\n\n    const ta = `ta:${canon(b.title)}|${canon(b.author)}`;\n    if (byTA.has(ta)) continue;\n    byTA.add(ta);\n    out.push(b);\n  }\n\n  return out;\n}\n\n/* ------------------------------ cache ------------------------------ */\nclass MemoryCache {\n  constructor(maxSize = CACHE_CONFIG.maxSize, ttl = CACHE_CONFIG.ttl) {\n    this.cache = new Map();\n    this.maxSize = maxSize;\n    this.ttl = ttl;\n  }\n  set(key, value) {\n    if (this.cache.size >= this.maxSize) {\n      const first = this.cache.keys().next().value;\n      this.cache.delete(first);\n    }\n    this.cache.set(key, { value, ts: Date.now() });\n  }\n  get(key) {\n    const item = this.cache.get(key);\n    if (!item) return null;\n    if (Date.now() - item.ts > this.ttl) {\n      this.cache.delete(key);\n      return null;\n    }\n    return item.value;\n  }\n  clear() {\n    this.cache.clear();\n  }\n}\n\n/* ------------------------------- API -------------------------------- */\nclass BooksAPI {\n  constructor() {\n    this.cache = new MemoryCache();\n  }\n\n  async getCategories() {\n    const key = 'categories';\n    const cached = this.cache.get(key);\n    if (cached) return cached;\n\n    try {\n      const data = await fetchJSON('/books/category-list');\n      let categories = [];\n\n      if (data && Array.isArray(data.results)) {\n        categories = data.results\n          .map(c => {\n            if (typeof c === 'object' && c.list_name)\n              return { name: c.list_name, value: c.list_name };\n            if (typeof c === 'string') return { name: c, value: c };\n            return null;\n          })\n          .filter(Boolean);\n      }\n      if (!categories.length)\n        categories = FALLBACK_CATEGORIES.map(n => ({ name: n, value: n }));\n      const result = [{ name: 'All Categories', value: 'all' }, ...categories];\n      this.cache.set(key, result); // Виправлено: k на key\n      return result;\n    } catch {\n      return [\n        { name: 'All Categories', value: 'all' },\n        ...FALLBACK_CATEGORIES.map(n => ({ name: n, value: n })),\n      ];\n    }\n  }\n\n  async getBooks(category = 'all', page = 1, limit) {\n    if (!limit) {\n      limit = window.innerWidth <= 768 ? 10 : 24;\n    }\n\n    const k = `books_${category}_${page}_${limit}`;\n    const cached = this.cache.get(k);\n    if (cached) return cached;\n\n    try {\n      let endpoint = '/books/top-books';\n      if (category !== 'all') {\n        endpoint = `/books/category?category=${encodeURIComponent(category)}`;\n      }\n\n      const data = await fetchJSON(endpoint);\n      const allBooks = [];\n      const seen = new Set();\n\n      if (category === 'all') {\n        if (Array.isArray(data)) {\n          data.forEach(list => {\n            if (Array.isArray(list.books)) {\n              list.books.forEach(b => {\n                const book = normalizeBook(b);\n                const key = `${book.title}__${book.image}`;\n                if (!seen.has(key)) {\n                  seen.add(key);\n                  allBooks.push(book);\n                }\n              });\n            }\n          });\n        }\n      } else {\n        const booksArray = data?.results?.length\n          ? data.results\n          : Array.isArray(data)\n          ? data\n          : [];\n        booksArray.forEach(b => {\n          const book = normalizeBook(b);\n          const key = `${book.title}__${book.image}`;\n          if (!seen.has(key)) {\n            seen.add(key);\n            allBooks.push(book);\n          }\n        });\n      }\n\n      if (!allBooks.length) {\n        console.log(`У категорії \"${category}\" немає книг.`);\n      }\n\n      const start = (page - 1) * limit;\n      const end = start + limit;\n\n      const result = {\n        books: allBooks.slice(start, end),\n        total: allBooks.length,\n        showing: Math.min(end, allBooks.length),\n        hasMore: end < allBooks.length,\n        currentPage: page,\n      };\n\n      this.cache.set(k, result);\n      return result;\n    } catch (e) {\n      throw new Error(`Failed to load books: ${e.message}`);\n    }\n  }\n}\n\nconst api = new BooksAPI();\n\nexport const getBookById = async id => {\n  try {\n    const { data } = await axios.get(`${BOOKS_BASE_URL}/books/${id}`);\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};","export default {\n  elBookModal: document.querySelector('#book-modal'),\n  elModalContent: document.querySelector('.modal-book-container'),\n  elBtnOpenModal: document.getElementById('open-modal-btn'),\n  footerForm: document.querySelector('.footer-input-box'),\n  footerInput: document.querySelector('.footer-input'),\n  footerRemark: document.querySelector('.footer-remark'),\n  footerBtn: document.querySelector('.footer-btn'),\n  elModalCloseBtn: document.querySelector('.modal-close-btn'), \n};\n\n","// src/js/render-functions.js\nimport { HTML_ESCAPE_MAP } from './constants.js';\nimport refs from './refs';\n\nexport function escapeHtml(text) {\n  if (!text) return '';\n  return String(text).replace(/[&<>\"']/g, m => HTML_ESCAPE_MAP[m]);\n}\n\n/** Single book card */\nexport function createBookCard(book, index = 0) {\n  const li = document.createElement('li');\n  li.className = 'book-card';\n  li.style.animationDelay = `${(index % 8) * 0.05 + 0.1}s`;\n\n  const priceText = book.price && book.price !== '$0' ? book.price : '';\n\n  li.innerHTML = `\n    <div class=\"book-media\">\n      <img\n        class=\"book-cover loading\"\n        src=\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='227' height='323'%3E%3Crect width='100%25' height='100%25' fill='%23f0f0f0'/%3E%3C/svg%3E\"\n        ${book.image ? `data-src=\"${book.image}\"` : ''}\n        alt=\"${escapeHtml(book.title)}\"\n        loading=\"lazy\"\n      >\n    </div>\n    <div class=\"book-info\">\n      <div class=\"book-title-row\">\n        <h3 class=\"book-title\">${escapeHtml(book.title)}</h3>\n        ${\n          priceText\n            ? `<span class=\"book-price\">${escapeHtml(priceText)}</span>`\n            : ''\n        }\n      </div>\n      <p class=\"book-author\">${escapeHtml(book.author)}</p>\n    </div>\n    <div class=\"book-footer\">\n      <button\n        class=\"learn-more-btn\"\n        type=\"button\"\n        data-book-id=\"${escapeHtml(book.id)}\"\n        data-amazon-url=\"${escapeHtml(book.amazon_product_url)}\"\n      >\n        Learn More\n      </button>\n    </div>\n  `;\n  return li;\n}\n\nexport function createCategoryItem(name, value, isActive) {\n  return `\n    <li class=\"category-item ${\n      isActive ? 'active' : ''\n    }\" data-category=\"${escapeHtml(value)}\">\n      <button class=\"category-button\" type=\"button\" data-category=\"${escapeHtml(\n        value\n      )}\">\n        ${escapeHtml(name)}\n      </button>\n    </li>\n  `;\n}\n\nexport function renderCategories(\n  container,\n  categories,\n  activeCategory = 'all'\n) {\n  if (!container) return;\n  container.innerHTML = categories\n    .map(c => createCategoryItem(c.name, c.value, c.value === activeCategory))\n    .join('');\n}\n\nexport function populateDropdowns(\n  dropdowns,\n  categories,\n  activeCategory = 'all'\n) {\n  dropdowns.forEach(select => {\n    if (!select) return;\n    select.innerHTML = categories\n      .map(\n        c => `<option value=\"${escapeHtml(c.value)}\" ${\n          c.value === activeCategory ? 'selected' : ''\n        }>\n          ${escapeHtml(c.name)}\n        </option>`\n      )\n      .join('');\n  });\n}\n\n/** Books list renderers */\nexport function renderBooks(container, books) {\n  if (!container) return;\n  container.innerHTML = '';\n  if (!books || books.length === 0) {\n    container.innerHTML = `<li class=\"no-books\">No books found</li>`;\n    return;\n  }\n  books.forEach((b, i) => {\n    const card = createBookCard(b, i);\n    container.appendChild(card);\n  });\n}\n\nexport function appendBooks(container, books) {\n  if (!container || !books?.length) return;\n  const start = container.children.length;\n  books.forEach((b, i) => {\n    const card = createBookCard(b, start + i);\n    container.appendChild(card);\n  });\n}\n\n/** UI helpers */\nexport function updateBooksCounter(counter, showing, total) {\n  if (counter) counter.textContent = `Showing ${showing} of ${total}`;\n}\n\nexport function updateShowMoreButton(button, hasMore, isLoading) {\n  if (!button) return;\n  const text = button.querySelector('.button-text');\n  if (!text) return;\n\n  if (isLoading) {\n    text.textContent = 'Loading...';\n    button.disabled = true;\n  } else if (hasMore) {\n    text.textContent = 'Show More';\n    button.disabled = false;\n    button.style.display = 'block';\n  } else {\n    button.style.display = 'none';\n  }\n}\n\nexport function showError(errorElement, message) {\n  if (!errorElement) return;\n  const messageElement = errorElement.querySelector('.error-message');\n  if (messageElement) messageElement.textContent = message;\n  errorElement.style.display = 'block';\n}\n\nexport function hideError(errorElement) {\n  if (errorElement) errorElement.style.display = 'none';\n}\n\nexport function setLoading(loader, listEl, isLoading) {\n  loader?.classList.toggle('hidden', !isLoading);\n  listEl?.setAttribute('aria-busy', String(isLoading));\n}\n\nexport function setCategoriesLoading(loader, isLoading) {\n  loader?.classList.toggle('hidden', !isLoading);\n}\n\nexport function updateCategoriesActiveState(container, activeCategory) {\n  if (!container) return;\n  container.querySelectorAll('.category-item').forEach(li => {\n    li.classList.toggle('active', li.dataset.category === activeCategory);\n  });\n}\n\nexport function createBookModalCard(book) {\n  const bookCard = document.createElement('div');\n  bookCard.className = 'modal-book-layout';\n\n  const priceDisplay =\n    book.price && book.price !== '0.00' ? book.price : '0.00';\n\n  const description =\n    book.description && book.description.trim() !== ''\n      ? book.description\n      : null;\n\n  const publisherText = book.publisher\n    ? `<br>Publisher: <b>${book.publisher}</b>.`\n    : null;\n\n  const weeksCount = book.weeks_on_list;\n  const weeksText = weeksCount === 1 ? 'week' : 'weeks';\n\n  const rankText =\n    book.rank && book.rank > 0 && weeksCount && weeksCount > 0\n      ? `<br>This book is ranked <b>#${book.rank}</b> on the bestseller list, having been on it for <b>${weeksCount}</b> ${weeksText}.`\n      : null;\n\n  let detailsContent = description || '';\n\n  if (description) {\n    let additionalInfo = '';\n    if (publisherText) additionalInfo += publisherText;\n    if (rankText) additionalInfo += rankText;\n\n    if (additionalInfo) {\n      detailsContent += additionalInfo;\n    }\n  }\n\n  if (!detailsContent) {\n    detailsContent = 'No description available for this book.';\n  }\n\n  bookCard.innerHTML = `\n        <img\n            class=\"book-cover-img\"\n            src=\"${book.book_image || ''}\"\n            alt=\"Book cover for '${book.title}' by ${book.author}\"\n            width=\"309\"\n            height=\"467\"\n        />\n\n        <div class=\"mobile-content\">\n            <div class=\"section-header\">\n                <h2 class=\"book-title-mobile\">${book.title}</h2>\n                <p class=\"book-author\">${book.author}</p>\n                <p class=\"price-mobile\">$${priceDisplay}</p>\n            </div>\n\n            <div class=\"quantity-control\" data-item-id=\"${book._id}\">\n                <button type=\"button\" class=\"decrease-btn\" aria-label=\"Decrease quantity\" disabled>-</button>\n                <input type=\"number\" class=\"quantity-input\" value=\"1\" min=\"1\" max=\"99\" aria-label=\"Book quantity\"/>\n                <button type=\"button\" class=\"increase-btn\" aria-label=\"Increase quantity\">+</button>\n            </div>\n\n            <div class=\"modal-book-actions\">\n                <button class=\"btn add-to-cart-btn\" type=\"button\" data-action=\"add-to-cart\">Add to Cart</button>\n                <button class=\"btn buy-now-btn btn-secondary\" type=\"button\" data-action=\"buy-now\">Buy Now</button>\n            </div>\n\n            <div class=\"accordion-container\">\n                <div class=\"ac\">\n                    <div class=\"ac-header\">\n                        <h4 class=\"ac-title\">Details</h4>\n                        <svg class=\"ac-icon arrow-down\" width=\"24\" height=\"25\">\n                            <use href=\"./img/symbol-defs.svg#icon-chevron-down\"></use>\n                        </svg>\n                        <svg class=\"ac-icon arrow-up\" width=\"24\" height=\"25\">\n                            <use href=\"./img/symbol-defs.svg#icon-chevron-up\"></use>\n                        </svg>\n                    </div>\n                    <div class=\"ac-panel\">\n                        <p class=\"ac-text\">${detailsContent}</p>\n                    </div>\n                </div>\n\n                <div class=\"ac\">\n                    <div class=\"ac-header\">\n                        <h4 class=\"ac-title\">Shipping</h4>\n                        <svg class=\"ac-icon arrow-down\" width=\"24\" height=\"25\">\n                            <use href=\"./img/symbol-defs.svg#icon-chevron-down\"></use>\n                        </svg>\n                        <svg class=\"ac-icon arrow-up\" width=\"24\" height=\"25\">\n                            <use href=\"./img/symbol-defs.svg#icon-chevron-up\"></use>\n                        </svg>\n                    </div>\n                    <div class=\"ac-panel\">\n                        <p class=\"ac-text\">\n                            We ship across the United States within 2-6 business days. All\n                            orders are processed through USPS or a reliable courier service. Enjoy free standard shipping on orders over $50.\n                        </p>\n                    </div>\n                </div>\n\n                <div class=\"ac\">\n                    <div class=\"ac-header\">\n                        <h4 class=\"ac-title\">Returns</h4>\n                        <svg class=\"ac-icon arrow-down\" width=\"24\" height=\"25\">\n                            <use href=\"./img/symbol-defs.svg#icon-chevron-down\"></use>\n                        </svg>\n                        <svg class=\"ac-icon arrow-up\" width=\"24\" height=\"25\">\n                            <use href=\"./img/symbol-defs.svg#icon-chevron-up\"></use>\n                        </svg>\n                    </div>\n                    <div class=\"ac-panel\">\n                        <p class=\"ac-text\">\n                            You can return an item within 14 days of receiving your order,\n                            provided it hasn't been used and is in its original condition.\n                            To start a return, please contact our support team — we'll guide you through the process quickly and hassle-free.\n                        </p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    `;\n  return bookCard;\n}\n","// -----footer-----\nimport { STORAGE_KEYS } from './constants.js';\n\nexport function saveEmailToLocal(email) {\n  const emails = JSON.parse(localStorage.getItem(STORAGE_KEYS.EMAILS)) || [];\n  if (!emails.includes(email)) {\n    emails.push(email);\n    localStorage.setItem(STORAGE_KEYS.EMAILS, JSON.stringify(emails));\n  }\n}\n\nexport function getEmailsFromLocal() {\n  return JSON.parse(localStorage.getItem(STORAGE_KEYS.EMAILS)) || [];\n}\n// -----footer-end-----\n\n//------modal-book-----\nexport const setLocalStorage = (key, array) =>\n  localStorage.setItem(key, JSON.stringify(array));\n\nexport const getLocalStorage = key =>\n  JSON.parse(localStorage.getItem(key)) || [];\n\nexport const removeLocalStorage = key => localStorage.removeItem(key);\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport refs from './refs.js';\nimport { CARTKEY } from './constants.js';\nimport {\n  getLocalStorage,\n  setLocalStorage,\n  removeLocalStorage,\n} from './storage.js';\n\nlet wasAddedToCart = false;\n\nexport function handleQuantityChange(targetBtn) {\n  const quantityControl = targetBtn.closest('.quantity-control');\n  const input = quantityControl.querySelector('.quantity-input');\n\n  let value = parseInt(input.value);\n  const min = parseInt(input.min) || 1;\n  const max = parseInt(input.max) || 99;\n\n  if (targetBtn.classList.contains('increase-btn') && value < max) {\n    input.value = value + 1;\n  } else if (targetBtn.classList.contains('decrease-btn') && value > min) {\n    input.value = value - 1;\n  }\n\n  quantityControl.querySelector('.decrease-btn').disabled =\n    parseInt(input.value) <= min;\n}\n\nexport function handleCartAction(action, currentBook) {\n  const quantityInput = refs.elModalContent.querySelector('.quantity-input');\n  const quantity = parseInt(quantityInput.value) || 1;\n  const bookPrice = Number(currentBook.price) || 0;\n\n  if (bookPrice <= 0) {\n    return showError(\n      `\"${currentBook.title}\" isn’t available right now.<br>Check back soon — we’ll restock it ASAP!`\n    );\n  }\n\n  const bookId = currentBook._id;\n  const itemTotalPrice = quantity * bookPrice;\n\n  if (action === 'add-to-cart') {\n    wasAddedToCart = true;\n\n    let cartArr = getLocalStorage(CARTKEY);\n\n    const newItem = {\n      id: bookId,\n      quantity,\n      price: bookPrice,\n      title: currentBook.title,\n    };\n\n    cartArr.push(newItem);\n    setLocalStorage(CARTKEY, cartArr);\n\n    const totalItems = cartArr.reduce(\n      (sum, item) => sum + (Number(item.quantity) || 0),\n      0\n    );\n    const totalAmount = cartArr.reduce(\n      (sum, item) =>\n        sum + (Number(item.quantity) || 0) * (Number(item.price) || 0),\n      0\n    );\n\n    showInfo(\n      `✅ You added <b>${quantity}</b> copies of \"<b>${\n        currentBook.title\n      }</b>\" to your cart for <b>$${itemTotalPrice.toFixed(2)}</b>.<br><br>\n       🛒 Cart total: <b>${totalItems}</b> items worth <b>$${totalAmount.toFixed(\n        2\n      )}</b>.`\n    );\n  } else if (action === 'buy-now') {\n    let cartArr = getLocalStorage(CARTKEY);\n    let itemsToPurchase = [];\n\n    const currentItem = {\n      id: bookId,\n      quantity,\n      price: bookPrice,\n      title: currentBook.title,\n    };\n\n    const existingItemIndex = cartArr.findIndex(item => item.id === bookId);\n\n    if (existingItemIndex !== -1) {\n      cartArr.splice(existingItemIndex, 1, currentItem);\n      itemsToPurchase = cartArr;\n    } else {\n      itemsToPurchase = [...cartArr, currentItem];\n    }\n\n    const totalUniqueItems = new Set(itemsToPurchase.map(item => item.id)).size;\n    const totalItems = itemsToPurchase.reduce(\n      (sum, item) => sum + (Number(item.quantity) || 0),\n      0\n    );\n    const totalAmount = itemsToPurchase.reduce(\n      (sum, item) =>\n        sum + (Number(item.quantity) || 0) * (Number(item.price) || 0),\n      0\n    );\n\n    showSuccess(\n      `🎉 You’ve successfully purchased <b>${totalUniqueItems}</b> unique titles (<b>${totalItems}</b> books total) for <b>$${totalAmount.toFixed(\n        2\n      )}</b>. Thank you for your purchase!`\n    );\n\n    removeLocalStorage(CARTKEY);\n  }\n}\n\n// === SPICY TOAST FUNCTIONS ===\nexport function showError(message) {\n  return iziToast.error({\n    title: '😔 Oops!',\n    message,\n    position: 'topRight',\n    timeout: 5000,\n    progressBarColor: '#ff6666',\n    maxWidth: 480,\n    messageSize: '16',\n    messageColor: '#000',\n  });\n}\n\nexport function showInfo(message) {\n  return iziToast.info({\n    title: '🛒 Cart Updated',\n    message,\n    position: 'topRight',\n    timeout: 5000,\n    maxWidth: 480,\n    messageSize: '16',\n    messageColor: '#000',\n  });\n}\n\nexport function showSuccess(message) {\n  return iziToast.success({\n    title: '🎉 PURCHASE SUCCESSFUL!',\n    message,\n    position: 'topRight',\n    timeout: 5000,\n    backgroundColor: '#8a2be2',\n    titleColor: '#fff',\n    messageColor: '#fff',\n    maxWidth: 480,\n    messageSize: '16',\n  });\n}\n\nexport function showRegistrationSuccess(name, email) {\n  return iziToast.success({\n    title: '🎉 Registration Successful!',\n    message: `Thank you for registering, ${name}! We will contact you at ${email}.`,\n    position: 'topRight',\n    timeout: 5000,\n    backgroundColor: '#28a745',\n    titleColor: '#fff',\n    messageColor: '#fff',\n    maxWidth: 480,\n    messageSize: '16',\n  });\n}","import Accordion from 'accordion-js';\nimport 'accordion-js/dist/accordion.min.css';\n\nimport refs from './refs.js'; \nimport { createBookModalCard } from './render-functions.js';\nimport { handleQuantityChange, handleCartAction } from './cart.js';\n\nlet lastFocusedElement = null;\nlet scrollPosition = 0;\nlet currentBook = null;\n\nexport async function openBookModal(book) {\n    if (!book || typeof book !== 'object') return;\n\n    currentBook = book;\n    lastFocusedElement = document.activeElement;\n    const modal = refs.elBookModal;\n\n    scrollPosition = window.scrollY;\n    document.body.style.top = `-${scrollPosition}px`;\n    document.body.style.position = 'fixed';\n    document.body.style.width = '100%';\n    document.body.style.overflow = 'hidden';\n\n    refs.elModalContent.querySelectorAll('.modal-book-layout').forEach(el => el.remove());\n    const bookCard = createBookModalCard(book);\n    refs.elModalContent.appendChild(bookCard);\n\n    modal.classList.add('active', 'is-open');\n    modal.setAttribute('aria-hidden', 'false');\n    refs.elModalCloseBtn.focus({ preventScroll: true });\n\n    refs.elBookModal.addEventListener('click', handleBookModal);\n    window.addEventListener('keydown', handleEsc, { once: true });\n\n    const accordions = Array.from(refs.elModalContent.querySelectorAll('.accordion-container'));\n    if (accordions.length > 0) {\n        new Accordion(accordions, {\n            duration: 300,\n            showMultiple: true,\n            triggerClass: 'ac-header',\n        });\n    }\n}\n\nexport function closeBookModal() {\n    const modal = refs.elBookModal;\n    refs.elBookModal.removeEventListener('click', handleBookModal);\n\n    modal.classList.remove('active', 'is-open');\n    modal.setAttribute('aria-hidden', 'true');\n    refs.elModalContent.querySelectorAll('.modal-book-layout').forEach(el => el.remove());\n\n    document.body.style.position = '';\n    document.body.style.top = '';\n    document.body.style.overflow = '';\n    window.scrollTo({ top: scrollPosition, behavior: 'instant' });\n\n    if (lastFocusedElement) {\n        lastFocusedElement.focus();\n        lastFocusedElement = null;\n    }\n    currentBook = null;\n}\n\nexport function handleBookModal(e) {\n    if (e.target.closest('.modal-close-btn') || e.target === refs.elBookModal) {\n        return closeBookModal();\n    }\n\n    const targetBtn = e.target.closest('.decrease-btn') || e.target.closest('.increase-btn');\n    if (targetBtn) {\n        return handleQuantityChange(targetBtn);\n    }\n\n    const actionBtn = e.target.closest('[data-action]');\n    if (actionBtn && currentBook) {\n        handleCartAction(actionBtn.dataset.action, currentBook);\n        if (actionBtn.dataset.action === 'buy-now') {\n        }\n    }\n}\n\nexport function handleEsc(e) {\n if (e.key === 'Escape') {\n  return closeBookModal();\n }\n}\n\n\n\nwindow.refs = refs;\nwindow.createBookModalCard = createBookModalCard;\n\nconst book = {\n  _id: '6867c877ac8a51f74dd67b11',\n  title: \"JUJUTSU KAISEN, VOL. 26\",\n  price: 15.99,\n  amazon_product_url: \"https://www.amazon.com/dp/1339005107?tag=thenewyorktim-20\",\n  cover_image: \"https://static01.nyt.com/bestsellers/images/9781974754977.jpg\"\n};\n\n// const card = createBookModalCard(book);\n// refs.elModalContent.appendChild(card);\n// console.log('Book card created:', card);","\n// -----footer-----\nexport function validateEmail(email) {\n  return /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email);\n}\n// -----footer-end-----","import refs  from './refs.js';\nimport { getBookById } from './api-service';\nimport { openBookModal } from './modal-book';\n\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { validateEmail } from './helpers.js';\nimport { TOAST_DELAY, MESSAGES } from './constants.js';\nimport { saveEmailToLocal } from './storage.js';\n\n\nexport function createShowMoreHandler(section) {\n  return () => section.loadMore();\n}\n\nexport function createBookClickHandler() {\n  return async function handler(e) {\n    const btn = e.target.closest('.learn-more-btn');\n    if (!btn) return;\n    e.preventDefault();\n\n    const bookId = btn.dataset.bookId;\n    if (!bookId || bookId === 'no-id') return;\n\n    try {\n      const bookData = await getBookById(bookId);\n      openBookModal(bookData);\n    } catch (error) {\n      console.error('Error fetching book:', error);\n    }\n  };\n}\n\nexport function createResizeHandler(section) {\n  return () => {\n    if (section.debounceTimeout) clearTimeout(section.debounceTimeout);\n    section.debounceTimeout = setTimeout(() => {\n      const cards =\n        section.elements.booksGrid?.querySelectorAll('.book-card') ?? [];\n      cards.forEach(\n        (card, i) => (card.style.animationDelay = `${(i % 8) * 0.05 + 0.1}s`)\n      );\n    }, 250);\n  };\n}\n\nexport function createCategoryChangeHandler(section) {\n  return e => section.filterByCategory(e.target.value);\n}\n\nexport function createCategoryButtonHandler(section) {\n  return e => {\n    const li = e.currentTarget.closest('.category-item');\n    const cat = li?.dataset.category;\n    if (cat && cat !== section.currentCategory) section.filterByCategory(cat);\n  };\n}\n\nexport function createRetryHandler(section) {\n  return () => section.loadBooks(true);\n}\n\nexport function createIntersectionObserver(onLoad) {\n  return new IntersectionObserver(\n    entries => {\n      entries.forEach(entry => {\n        if (entry.isIntersecting) onLoad(entry.target);\n      });\n    },\n    { rootMargin: '50px 0px' }\n  );\n}\n\nexport function loadImage(img, observer) {\n  const src = img.dataset.src;\n  if (!src) return;\n  img.classList.add('loading');\n  const t = new Image();\n  t.onload = () => {\n    img.src = src;\n    img.classList.remove('loading');\n    img.classList.add('loaded');\n    delete img.dataset.src;\n    observer?.unobserve(img);\n  };\n  t.onerror = () => {\n    img.classList.remove('loading');\n    img.classList.add('error');\n    observer?.unobserve(img);\n  };\n  t.src = src;\n}\n\n// -----footer-----\nfunction showToast(type, title, message) {\n  iziToast[type]({\n    title,\n    message,\n    position: 'topRight',\n  });\n}\n\nexport function onFooterSubmit(e) {\n  e.preventDefault();\n\n  const email = refs.footerInput.value.trim();\n\n  refs.footerBtn.classList.remove('btn-error', 'btn-success');\n  refs.footerRemark.classList.remove('remark-error', 'remark-success');\n  refs.footerInput.classList.remove('error', 'success');\n\n  if (!email) {\n    refs.footerRemark.textContent = MESSAGES.REQUIRED;\n    refs.footerRemark.classList.add('remark-error');\n    refs.footerInput.classList.add('error');\n    showToast('warning', 'Caution', MESSAGES.REQUIRED);\n    setTimeout(clearFormState, TOAST_DELAY);\n    return;\n  }\n\n  if (!validateEmail(email)) {\n    refs.footerRemark.textContent = MESSAGES.INVALID;\n    refs.footerRemark.classList.add('remark-error');\n    refs.footerBtn.classList.add('btn-error');\n    refs.footerInput.classList.add('error');\n    showToast('error', 'Error', MESSAGES.INVALID);\n    setTimeout(clearFormState, TOAST_DELAY);\n    return;\n  }\n\n  refs.footerRemark.textContent = '✅ ' + MESSAGES.SUCCESS;\n  refs.footerRemark.classList.add('remark-success');\n  refs.footerBtn.classList.add('btn-success');\n  refs.footerInput.classList.add('success');\n  showToast('success', 'OK', MESSAGES.SUCCESS);\n\n  saveEmailToLocal(email);\n\n  setTimeout(clearFormState, TOAST_DELAY);\n  refs.footerForm.reset();\n}\n\nfunction clearFormState() {\n  refs.footerRemark.textContent = '';\n  refs.footerRemark.classList.remove('remark-error', 'remark-success');\n  refs.footerBtn.classList.remove('btn-error', 'btn-success');\n  refs.footerInput.classList.remove('error', 'success');\n}\n// -----footer-end-----\n\n//-----modal-book----\n","// src/js/books-data.js\nimport { api } from './api-service.js';\nimport { DOM_ELEMENTS, BOOKS_CONFIG } from './constants.js';\nimport {\n  renderCategories,\n  populateDropdowns,\n  renderBooks,\n  appendBooks,\n  updateBooksCounter,\n  updateShowMoreButton,\n  showError,\n  hideError,\n  setLoading,\n  setCategoriesLoading,\n  updateCategoriesActiveState,\n} from './render-functions.js';\nimport {\n  createShowMoreHandler,\n  createBookClickHandler,\n  createResizeHandler,\n  createCategoryChangeHandler,\n  createCategoryButtonHandler,\n  createRetryHandler,\n  createIntersectionObserver,\n  loadImage,\n} from './handlers.js';\n\n/* ----------------------------- UI-level dedupe ----------------------------- */\nfunction norm(s) {\n  return String(s || '')\n    .toLowerCase()\n    .replace(/&amp;/g, '&')\n    .replace(/\\s+/g, ' ')\n    .replace(/[^\\p{L}\\p{N}\\s]/gu, '')\n    .trim();\n}\n\nfunction keyTA(b) {\n  const t = norm(b.title);\n  const a = norm(b.author);\n  return t || a ? `ta:${t}|${a}` : `id:${b.id || 'no-id'}`;\n}\n\nfunction dedupeForUI(list = []) {\n  const seen = new Set();\n  const out = [];\n  for (const b of list) {\n    const k = keyTA(b);\n    if (seen.has(k)) continue;\n    seen.add(k);\n    out.push(b);\n  }\n  return out;\n}\n\n/**\n * Merge `existing` with `candidates` and take at most `takeCount` NEW unique items\n * (unique by title+author). Returns { merged, newItems }.\n */\nfunction mergeTakeNew(existing, candidates, takeCount) {\n  const seen = new Set(existing.map(keyTA));\n  const merged = existing.slice();\n  const newItems = [];\n  for (const b of candidates) {\n    const k = keyTA(b);\n    if (seen.has(k)) continue;\n    seen.add(k);\n    merged.push(b);\n    newItems.push(b);\n    if (newItems.length >= takeCount) break;\n  }\n  return { merged, newItems };\n}\n\n/* --------------------------------- Class ---------------------------------- */\nclass BooksSection {\n  constructor() {\n    this.elements = {\n      booksGrid: document.getElementById(DOM_ELEMENTS.booksGrid),\n      booksLoader: document.getElementById(DOM_ELEMENTS.booksLoader),\n      showMoreBtn: document.getElementById(DOM_ELEMENTS.showMoreBtn),\n      categoriesUL: document.getElementById(DOM_ELEMENTS.categoriesList),\n      categoriesLoader: document.getElementById(DOM_ELEMENTS.categoriesLoader),\n      errorElement: document.getElementById(DOM_ELEMENTS.booksError),\n      booksCounter: document.getElementById(DOM_ELEMENTS.booksCounter),\n      categoriesSelectTablet: document.getElementById(\n        DOM_ELEMENTS.categoriesSelectTablet\n      ),\n      categoriesSelectMobile: document.getElementById(\n        DOM_ELEMENTS.categoriesSelectMobile\n      ),\n    };\n\n    this.currentCategory = 'all';\n    this.currentPage = 1;\n    this.isLoading = false;\n    this.hasMore = true;\n    this.loadedBooks = [];\n\n    this.imageObserver = null;\n    this.debounceTimeout = null;\n\n    this.initialCount = this.getInitialBooksCount();\n    this.init();\n  }\n\n  async init() {\n    try {\n      hideError(this.elements.errorElement);\n      this.setupEventListeners();\n      this.setupObservers();\n      await this.renderCategories();\n      await this.loadBooks(true);\n    } catch (e) {\n      console.error('Books init error:', e);\n      showError(\n        this.elements.errorElement,\n        'Failed to load books. Please try again.'\n      );\n    }\n  }\n\n  setupEventListeners() {\n    this.elements.showMoreBtn?.addEventListener(\n      'click',\n      createShowMoreHandler(this)\n    );\n    this.elements.booksGrid?.addEventListener(\n      'click',\n      createBookClickHandler()\n    );\n    window.addEventListener('resize', createResizeHandler(this));\n    this.elements.categoriesSelectTablet?.addEventListener(\n      'change',\n      createCategoryChangeHandler(this)\n    );\n    this.elements.categoriesSelectMobile?.addEventListener(\n      'change',\n      createCategoryChangeHandler(this)\n    );\n    this.elements.errorElement\n      ?.querySelector('.retry-btn')\n      ?.addEventListener('click', createRetryHandler(this));\n  }\n\n  setupObservers() {\n    if ('IntersectionObserver' in window) {\n      this.imageObserver = createIntersectionObserver(img =>\n        loadImage(img, this.imageObserver)\n      );\n    }\n  }\n\n  async renderCategories() {\n    if (!this.elements.categoriesUL) return;\n    setCategoriesLoading(this.elements.categoriesLoader, true);\n    try {\n      const categories = await api.getCategories();\n      renderCategories(\n        this.elements.categoriesUL,\n        categories,\n        this.currentCategory\n      );\n      this.elements.categoriesUL\n        .querySelectorAll('.category-button')\n        .forEach(btn =>\n          btn.addEventListener('click', createCategoryButtonHandler(this))\n        );\n      populateDropdowns(\n        [\n          this.elements.categoriesSelectTablet,\n          this.elements.categoriesSelectMobile,\n        ],\n        categories,\n        this.currentCategory\n      );\n    } finally {\n      setCategoriesLoading(this.elements.categoriesLoader, false);\n    }\n  }\n\n  async loadBooks(reset = false) {\n    if (this.isLoading) return;\n    this.setLoading(true);\n    hideError(this.elements.errorElement);\n    try {\n      const limit = reset\n        ? this.getInitialBooksCount()\n        : window.innerWidth <= BOOKS_CONFIG.mobileBreakpoint\n        ? BOOKS_CONFIG.perLoadMoreMobile\n        : BOOKS_CONFIG.perLoadMoreDesktop;\n      const page = reset ? 1 : this.currentPage + 1;\n      const data = await api.getBooks(this.currentCategory, page, limit);\n\n      if (reset) {\n        this.loadedBooks = [...data.books];\n        this.currentPage = 1;\n        renderBooks(this.elements.booksGrid, this.loadedBooks);\n      } else {\n        this.loadedBooks.push(...data.books);\n        this.currentPage = page;\n        appendBooks(this.elements.booksGrid, data.books);\n      }\n\n      this.setupLazyLoading();\n\n      const total =\n        typeof data.total === 'number'\n          ? data.total\n          : dedupeForUI(this.loadedBooks).length;\n\n      // hasMore if server still has items AND we still didn't hit total\n      this.hasMore = Boolean(data.hasMore) && this.loadedBooks.length < total;\n\n      this.updateShowMoreButton();\n      updateBooksCounter(\n        this.elements.booksCounter,\n        this.loadedBooks.length,\n        total\n      );\n    } catch (e) {\n      console.error('Load books error:', e);\n      showError(\n        this.elements.errorElement,\n        `Failed to load books: ${e.message}`\n      );\n    } finally {\n      this.setLoading(false);\n    }\n  }\n\n  setupLazyLoading() {\n    if (!this.imageObserver) return;\n    this.elements.booksGrid\n      ?.querySelectorAll('.book-cover[data-src]')\n      .forEach(img => this.imageObserver.observe(img));\n  }\n\n  async filterByCategory(category) {\n    if (category === this.currentCategory) return;\n\n    this.currentCategory = category;\n    this.currentPage = 1;\n    this.loadedBooks = [];\n\n    updateCategoriesActiveState(this.elements.categoriesUL, category);\n    if (this.elements.categoriesSelectTablet)\n      this.elements.categoriesSelectTablet.value = category;\n    if (this.elements.categoriesSelectMobile)\n      this.elements.categoriesSelectMobile.value = category;\n    await this.loadBooks(true);\n  }\n\n  async loadMore() {\n    if (!this.hasMore || this.isLoading) return;\n    await this.loadBooks(false);\n  }\n  updateShowMoreButton() {\n    updateShowMoreButton(\n      this.elements.showMoreBtn,\n      this.hasMore,\n      this.isLoading\n    );\n  }\n  getInitialBooksCount() {\n    return window.innerWidth <= BOOKS_CONFIG.mobileBreakpoint\n      ? BOOKS_CONFIG.initialPerPageMobile\n      : BOOKS_CONFIG.initialPerPageDesktop;\n  }\n  setLoading(v) {\n    this.isLoading = v;\n    setLoading(this.elements.booksLoader, this.elements.booksGrid, v);\n    this.updateShowMoreButton();\n  }\n  destroy() {\n    this.imageObserver?.disconnect();\n    if (this.debounceTimeout) clearTimeout(this.debounceTimeout);\n  }\n}\n\nexport default BooksSection;\n","import BooksSection from './books-data.js';\n\n// Keep a single instance across HMR & repeated imports\nlet instance = window.__booksSectionInstance || null;\n\nexport function mountBooks() {\n  if (instance) return instance;\n  instance = new BooksSection();\n  window.__booksSectionInstance = instance;\n  return instance;\n}\n\n// Auto–mount exactly once\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', () => mountBooks(), { once: true });\n} else {\n  mountBooks();\n}\n\n// Clean up on Vite HMR to avoid duplicated mounts\nif (import.meta?.hot) {\n  import.meta.hot.dispose(() => {\n    if (instance) {\n      instance.destroy?.();\n      instance = null;\n      window.__booksSectionInstance = null;\n    }\n  });\n}\n\n\n","import {showRegistrationSuccess} from './cart'\nconst modalBackdrop = document.getElementById('modal');\nconst modal = modalBackdrop.querySelector('.modal-content');\nconst modalEventTitle = document.getElementById('modal-event-title');\nconst openButtons = document.querySelectorAll('.open-modal-btn, #open-contact');\nconst closeButtons = modalBackdrop.querySelectorAll('.modal-close-btn');\nconst form = document.querySelector('.register-form');\nlet lastFocusedEl = null;\n\n//     POTENTIAL PROBLEM\n\nfunction openModal(eventTitle, opener) {\n  lastFocusedEl = opener || document.activeElement;\n  modalBackdrop.classList.add('active');\n  document.body.style.overflow = 'hidden'; \n  const firstInput = modal.querySelector('input, textarea, button');\n  firstInput && firstInput.focus();\n  // add key listener\n  document.addEventListener('keydown', handleKeydown);\n}\n\nfunction closeModal() {\n  modalBackdrop.classList.remove('active');\n  document.body.style.overflow = '';\n  // повертаємо фокус\n  lastFocusedEl && lastFocusedEl.focus();\n  document.removeEventListener('keydown', handleKeydown);\n}\n\n// Open buttons attach\nopenButtons.forEach(btn => {\n  btn.addEventListener('click', e => {\n    const title = btn.dataset.eventTitle;\n    modalEventTitle.textContent = title;\n    btn.getAttribute('data-event-title');\n    openModal(title, btn);\n  });\n});\n\n// Close by clicking backdrop (але не по модалці)\nmodalBackdrop.addEventListener('click', e => {\n  if (e.target === modalBackdrop) {\n    closeModal();\n  }\n});\n\n// Close buttons\ncloseButtons.forEach(b => b.addEventListener('click', closeModal));\n\n// Key handling (Escape)\nfunction handleKeydown(e) {\n  if (e.key === 'Escape') {\n    closeModal();\n  }\n  // Simple focus trap: keep focus inside modal for Tab\n  if (e.key === 'Tab') {\n    trapTabKey(e);\n  }\n}\n\n// Very small focus trap\nfunction trapTabKey(e) {\n  const focusable = modal.querySelectorAll(\n    'a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex=\"-1\"])'\n  );\n  if (!focusable.length) return;\n  const first = focusable[0];\n  const last = focusable[focusable.length - 1];\n  if (e.shiftKey && document.activeElement === first) {\n    last.focus();\n    e.preventDefault();\n  } else if (!e.shiftKey && document.activeElement === last) {\n    first.focus();\n    e.preventDefault();\n  }\n}\n\n// Simple form handling (client-side validation shown)\nform.addEventListener('submit', e => {\n  e.preventDefault();\n  if (!form.checkValidity()) {\n    // Find first invalid element and focus\n    const invalid = form.querySelector(':invalid');\n    if (invalid) invalid.focus();\n    return;\n  }\n\n  // Simulate successful submission\n  const name = form.name.value;\n  const email = form.email.value;\n  console.log('Submitted:', { name, email, message: form.message.value });\n  closeModal();\n  showRegistrationSuccess(`Thank you for registering, ${name}! We will contact you at ${email}.`);\n  form.reset();\n});\n  \n  // Set current year in footer\n  // document.getElementById('year').textContent = new Date().getFullYear();\n  \n\n","import Swiper from 'swiper';\nimport 'swiper/css';\nimport 'swiper/css/navigation';\nimport 'swiper/css/pagination';\nimport {\n  Navigation,\n  Pagination,\n  A11y,\n  Keyboard,\n  Mousewheel,\n} from 'swiper/modules';\n\nSwiper.use([Navigation, Pagination, A11y, Keyboard, Mousewheel]);\n\nconst swiperElement = document.querySelector('.events-slider');\nconst eventSlider = new Swiper(swiperElement, {\n  slidesPerView: 1,\n  spaceBetween: 24,\n  watchOverflow: true,\n\n  navigation: {\n    nextEl: '.events-section .swiper-arrows .swiper-button-next',\n    prevEl: '.events-section .swiper-arrows .swiper-button-prev',\n  },\n  pagination: {\n    el: '.events-section .carousel-navigation .swiper-pagination',\n    clickable: true,\n  },\n  a11y: {\n    enabled: true,\n  },\n  keyboard: {\n    enabled: true,\n  },\n  mousewheel: {\n    enabled: true,\n    forceToAxis: true,\n  },\n\n  breakpoints: {\n    320: {\n      slidesPerView: 1,\n      spaceBetween: 24,\n    },\n    768: {\n      slidesPerView: 2,\n      spaceBetween: 32,\n    },\n    1440: {\n      slidesPerView: 3,\n      spaceBetween: 32,\n    },\n  },\n});\n","import refs  from './refs.js';\nimport { onFooterSubmit } from './handlers.js';\n\nrefs.footerForm.addEventListener('submit', onFooterSubmit);\n\n"],"names":["refs","closeNavbar","Swiper","Navigation","Pagination","A11y","Keyboard","Mousewheel","swiperElement","swiper","nextBtn","prevBtn","updateButtons","BOOKS_BASE_URL","REQUEST_TIMEOUT","RETRY_ATTEMPTS","RETRY_DELAY","BOOKS_CONFIG","CACHE_CONFIG","FALLBACK_CATEGORIES","DOM_ELEMENTS","HTML_ESCAPE_MAP","STORAGE_KEYS","TOAST_DELAY","MESSAGES","CARTKEY","fetchJSON","path","options","controller","timeoutId","lastError","attempt","res","txt","err","r","normalizeBook","book","fallbackImage","MemoryCache","maxSize","ttl","key","value","first","item","BooksAPI","cached","data","categories","c","n","result","category","page","limit","k","endpoint","allBooks","seen","list","b","_a","start","end","e","api","getBookById","id","axios","error","escapeHtml","text","m","createBookCard","index","li","priceText","createCategoryItem","name","isActive","renderCategories","container","activeCategory","populateDropdowns","dropdowns","select","renderBooks","books","i","card","appendBooks","updateBooksCounter","counter","showing","total","updateShowMoreButton","button","hasMore","isLoading","showError","errorElement","message","messageElement","hideError","setLoading","loader","listEl","setCategoriesLoading","updateCategoriesActiveState","createBookModalCard","bookCard","priceDisplay","description","publisherText","weeksCount","weeksText","rankText","detailsContent","additionalInfo","saveEmailToLocal","email","emails","setLocalStorage","array","getLocalStorage","removeLocalStorage","handleQuantityChange","targetBtn","quantityControl","input","min","max","handleCartAction","action","currentBook","quantityInput","quantity","bookPrice","bookId","itemTotalPrice","cartArr","newItem","totalItems","sum","totalAmount","showInfo","itemsToPurchase","currentItem","existingItemIndex","totalUniqueItems","showSuccess","iziToast","showRegistrationSuccess","lastFocusedElement","scrollPosition","openBookModal","modal","el","handleBookModal","handleEsc","accordions","Accordion","closeBookModal","actionBtn","validateEmail","createShowMoreHandler","section","createBookClickHandler","btn","bookData","createResizeHandler","createCategoryChangeHandler","createCategoryButtonHandler","cat","createRetryHandler","createIntersectionObserver","onLoad","entries","entry","loadImage","img","observer","src","t","showToast","type","title","onFooterSubmit","clearFormState","norm","s","keyTA","a","dedupeForUI","out","BooksSection","_b","_c","_d","_f","_e","reset","v","instance","mountBooks","modalBackdrop","modalEventTitle","openButtons","closeButtons","form","lastFocusedEl","openModal","eventTitle","opener","firstInput","handleKeydown","closeModal","trapTabKey","focusable","last","invalid"],"mappings":"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"}