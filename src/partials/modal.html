<svg
  aria-hidden="true"
  style="position: absolute; width: 0; height: 0; overflow: hidden"
  version="1.1"
  xmlns="http://www.w3.org/2000/svg"
  xmlns:xlink="http://www.w3.org/1999/xlink"
>
  <defs>
    <symbol id="icon-x" viewBox="0 0 32 32">
      <path
        d="M21.589 8.459l-5.657 5.656-5.656-5.656-1.885 1.885 5.656 5.656-5.656 5.656 1.885 1.885 5.656-5.656 5.657 5.656 1.885-1.885-5.656-5.656 5.656-5.656z"
      ></path>
    </symbol>
  </defs>
</svg>

<div class="modal-backdrop active" id="book-modal" aria-hidden="true">
  <div class="modal-container">
    <div class="modal-content">
      <button
        type="button"
        class="modal-close-btn"
        aria-label="Закрити модальне вікно"
      >
        <svg width="24" height="24">
          <use href="#icon-x"></use>
        </svg>
      </button>

      <div class="modal-book-layout">
        <img
          class="book-cover-img"
          src="{{bookCoverUrl}}"
          alt="Обкладинка книги '{{bookTitle}}' автора {{bookAuthor}}"
          width="309"
        />

        <div class="mobile-content">
          <div class="section-header">
            <h2 class="book-title-mobile h2">{{bookTitle}}</h2>
            <p class="h3">{{bookAuthor}}</p>
            <p class="price-mobile">${{bookPrice}}</p>

            <div class="quantity-control" data-item-id="${{bookId}}">
              <button
                type="button"
                class="decrease-btn"
                aria-label="Decrease quantity"
                disabled
              >
                -
              </button>
              <input
                type="number"
                class="quantity-input"
                value="1"
                min="1"
                max="99"
                aria-label="Book quantity"
              />
              <button
                type="button"
                class="increase-btn"
                aria-label="Increase quantity"
              >
                +
              </button>
            </div>

            <div class="modal-book-actions">
              <button
                class="btn add-to-cart-btn"
                type="button"
                data-action="add-to-cart"
              >
                Add to Cart
              </button>
              <button
                class="btn buy-now-btn btn-secondary"
                type="button"
                data-action="buy-now"
              >
                Buy Now
              </button>
            </div>
          </div>

          <div class="accordion-container">
            <div class="ac">
              <h2 class="ac-header">
                <button type="button" class="ac-trigger">Details</button>
              </h2>
              <div class="ac-panel">
                <p class="ac-text">{{bookDescription}}</p>
              </div>
            </div>
          </div>

          <div class="accordion-container">
            <div class="ac">
              <h2 class="ac-header">
                <button type="button" class="ac-trigger">Shipping</button>
              </h2>
              <div class="ac-panel">
                <p class="ac-text">
                  We ship across the United States within 2-6 business days. All
                  orders are processed through USPS or a reliable courier
                  service. Enjoy free standard shipping on orders over $50.
                </p>
              </div>
            </div>
          </div>

          <div class="accordion-container">
            <div class="ac">
              <h2 class="ac-header">
                <button type="button" class="ac-trigger">Returns</button>
              </h2>
              <div class="ac-panel">
                <p class="ac-text">
                  You can return an item within 14 days of receiving your order,
                  provided it hasn't been used and is in its original condition.
                  To start a return, please contact our support team — we'll
                  guide you through the process quickly and hassle-free.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  const modal = document.getElementById('book-modal');
  const closeBtn = modal.querySelector('.modal-close-btn');

  const toggleModal = () => {
    modal.classList.toggle('active');
    // Додаємо клас modal-open на <html> та <body> для блокування скролу
    document.body.classList.toggle('modal-open');
    document.documentElement.classList.toggle('modal-open');
  };

  closeBtn.addEventListener('click', toggleModal);

  modal.addEventListener('click', e => {
    // Закрити при кліку на backdrop
    if (e.target.classList.contains('modal-backdrop')) {
      toggleModal();
    }
  });

  document.addEventListener('keydown', e => {
    // Закрити по Esc
    if (e.key === 'Escape' && modal.classList.contains('active')) {
      toggleModal();
    }
  });
</script>
